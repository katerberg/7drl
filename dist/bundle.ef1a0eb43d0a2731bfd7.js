!function(e){var t={};function i(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/",i(i.s=13)}([function(e,t,i){"use strict";const r=2.3283064365386963e-10;class n{constructor(){this._seed=0,this._s0=0,this._s1=0,this._s2=0,this._c=0}getSeed(){return this._seed}setSeed(e){return e=e<1?1/e:e,this._seed=e,this._s0=(e>>>0)*r,e=69069*e+1>>>0,this._s1=e*r,e=69069*e+1>>>0,this._s2=e*r,this._c=1,this}getUniform(){let e=2091639*this._s0+this._c*r;return this._s0=this._s1,this._s1=this._s2,this._c=0|e,this._s2=e-this._c,this._s2}getUniformInt(e,t){let i=Math.max(e,t),r=Math.min(e,t);return Math.floor(this.getUniform()*(i-r+1))+r}getNormal(e=0,t=1){let i,r,n;do{i=2*this.getUniform()-1,r=2*this.getUniform()-1,n=i*i+r*r}while(n>1||0==n);return e+i*Math.sqrt(-2*Math.log(n)/n)*t}getPercentage(){return 1+Math.floor(100*this.getUniform())}getItem(e){return e.length?e[Math.floor(this.getUniform()*e.length)]:null}shuffle(e){let t=[],i=e.slice();for(;i.length;){let e=i.indexOf(this.getItem(i));t.push(i.splice(e,1)[0])}return t}getWeightedValue(e){let t=0;for(let i in e)t+=e[i];let i,r=this.getUniform()*t,n=0;for(i in e)if(n+=e[i],r<n)return i;return i}getState(){return[this._s0,this._s1,this._s2,this._c]}setState(e){return this._s0=e[0],this._s1=e[1],this._s2=e[2],this._c=e[3],this}clone(){return(new n).setState(this.getState())}}t.a=(new n).setSeed(Date.now())},function(e,t,i){"use strict";function r(e,t){return(e%t+t)%t}function n(e,t=0,i=1){return e<t?t:e>i?i:e}function a(e){return e.charAt(0).toUpperCase()+e.substring(1)}function o(e,...t){let i=o.map;return e.replace(/%(?:([a-z]+)|(?:{([^}]+)}))/gi,(function(r,n,o,s){if("%"==e.charAt(s-1))return r.substring(1);if(!t.length)return r;let l=t[0],h=(n||o).split(","),c=h.shift()||"",u=i[c.toLowerCase()];if(!u)return r;l=t.shift();let d=l[u].apply(l,h),f=c.charAt(0);return f!=f.toLowerCase()&&(d=a(d)),d}))}i.r(t),i.d(t,"mod",(function(){return r})),i.d(t,"clamp",(function(){return n})),i.d(t,"capitalize",(function(){return a})),i.d(t,"format",(function(){return o})),o.map={s:"toString"}},function(e,t,i){"use strict";i.r(t),i.d(t,"fromString",(function(){return a})),i.d(t,"add",(function(){return o})),i.d(t,"add_",(function(){return s})),i.d(t,"multiply",(function(){return l})),i.d(t,"multiply_",(function(){return h})),i.d(t,"interpolate",(function(){return c})),i.d(t,"lerp",(function(){return u})),i.d(t,"interpolateHSL",(function(){return d})),i.d(t,"lerpHSL",(function(){return f})),i.d(t,"randomize",(function(){return p})),i.d(t,"rgb2hsl",(function(){return g})),i.d(t,"hsl2rgb",(function(){return _})),i.d(t,"toRGB",(function(){return b})),i.d(t,"toHex",(function(){return y}));var r=i(1),n=i(0);function a(e){let t,i;if(e in v)t=v[e];else{if("#"==e.charAt(0)){let i=(e.match(/[0-9a-f]/gi)||[]).map(e=>parseInt(e,16));if(3==i.length)t=i.map(e=>17*e);else{for(let e=0;e<3;e++)i[e+1]+=16*i[e],i.splice(e,1);t=i}}else t=(i=e.match(/rgb\(([0-9, ]+)\)/i))?i[1].split(/\s*,\s*/).map(e=>parseInt(e)):[0,0,0];v[e]=t}return t.slice()}function o(e,...t){let i=e.slice();for(let e=0;e<3;e++)for(let r=0;r<t.length;r++)i[e]+=t[r][e];return i}function s(e,...t){for(let i=0;i<3;i++)for(let r=0;r<t.length;r++)e[i]+=t[r][i];return e}function l(e,...t){let i=e.slice();for(let e=0;e<3;e++){for(let r=0;r<t.length;r++)i[e]*=t[r][e]/255;i[e]=Math.round(i[e])}return i}function h(e,...t){for(let i=0;i<3;i++){for(let r=0;r<t.length;r++)e[i]*=t[r][i]/255;e[i]=Math.round(e[i])}return e}function c(e,t,i=.5){let r=e.slice();for(let n=0;n<3;n++)r[n]=Math.round(r[n]+i*(t[n]-e[n]));return r}const u=c;function d(e,t,i=.5){let r=g(e),n=g(t);for(let e=0;e<3;e++)r[e]+=i*(n[e]-r[e]);return _(r)}const f=d;function p(e,t){t instanceof Array||(t=Math.round(n.a.getNormal(0,t)));let i=e.slice();for(let e=0;e<3;e++)i[e]+=t instanceof Array?Math.round(n.a.getNormal(0,t[e])):t;return i}function g(e){let t,i=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(i,r,n),o=Math.min(i,r,n),s=0,l=(a+o)/2;if(a==o)t=0;else{let e=a-o;switch(t=l>.5?e/(2-a-o):e/(a+o),a){case i:s=(r-n)/e+(r<n?6:0);break;case r:s=(n-i)/e+2;break;case n:s=(i-r)/e+4}s/=6}return[s,t,l]}function m(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function _(e){let t=e[2];if(0==e[1])return t=Math.round(255*t),[t,t,t];{let i=e[1],r=t<.5?t*(1+i):t+i-t*i,n=2*t-r,a=m(n,r,e[0]+1/3),o=m(n,r,e[0]),s=m(n,r,e[0]-1/3);return[Math.round(255*a),Math.round(255*o),Math.round(255*s)]}}function b(e){return`rgb(${e.map(e=>Object(r.clamp)(e,0,255)).join(",")})`}function y(e){return`#${e.map(e=>Object(r.clamp)(e,0,255).toString(16).padStart(2,"0")).join("")}`}const v={black:[0,0,0],navy:[0,0,128],darkblue:[0,0,139],mediumblue:[0,0,205],blue:[0,0,255],darkgreen:[0,100,0],green:[0,128,0],teal:[0,128,128],darkcyan:[0,139,139],deepskyblue:[0,191,255],darkturquoise:[0,206,209],mediumspringgreen:[0,250,154],lime:[0,255,0],springgreen:[0,255,127],aqua:[0,255,255],cyan:[0,255,255],midnightblue:[25,25,112],dodgerblue:[30,144,255],forestgreen:[34,139,34],seagreen:[46,139,87],darkslategray:[47,79,79],darkslategrey:[47,79,79],limegreen:[50,205,50],mediumseagreen:[60,179,113],turquoise:[64,224,208],royalblue:[65,105,225],steelblue:[70,130,180],darkslateblue:[72,61,139],mediumturquoise:[72,209,204],indigo:[75,0,130],darkolivegreen:[85,107,47],cadetblue:[95,158,160],cornflowerblue:[100,149,237],mediumaquamarine:[102,205,170],dimgray:[105,105,105],dimgrey:[105,105,105],slateblue:[106,90,205],olivedrab:[107,142,35],slategray:[112,128,144],slategrey:[112,128,144],lightslategray:[119,136,153],lightslategrey:[119,136,153],mediumslateblue:[123,104,238],lawngreen:[124,252,0],chartreuse:[127,255,0],aquamarine:[127,255,212],maroon:[128,0,0],purple:[128,0,128],olive:[128,128,0],gray:[128,128,128],grey:[128,128,128],skyblue:[135,206,235],lightskyblue:[135,206,250],blueviolet:[138,43,226],darkred:[139,0,0],darkmagenta:[139,0,139],saddlebrown:[139,69,19],darkseagreen:[143,188,143],lightgreen:[144,238,144],mediumpurple:[147,112,216],darkviolet:[148,0,211],palegreen:[152,251,152],darkorchid:[153,50,204],yellowgreen:[154,205,50],sienna:[160,82,45],brown:[165,42,42],darkgray:[169,169,169],darkgrey:[169,169,169],lightblue:[173,216,230],greenyellow:[173,255,47],paleturquoise:[175,238,238],lightsteelblue:[176,196,222],powderblue:[176,224,230],firebrick:[178,34,34],darkgoldenrod:[184,134,11],mediumorchid:[186,85,211],rosybrown:[188,143,143],darkkhaki:[189,183,107],silver:[192,192,192],mediumvioletred:[199,21,133],indianred:[205,92,92],peru:[205,133,63],chocolate:[210,105,30],tan:[210,180,140],lightgray:[211,211,211],lightgrey:[211,211,211],palevioletred:[216,112,147],thistle:[216,191,216],orchid:[218,112,214],goldenrod:[218,165,32],crimson:[220,20,60],gainsboro:[220,220,220],plum:[221,160,221],burlywood:[222,184,135],lightcyan:[224,255,255],lavender:[230,230,250],darksalmon:[233,150,122],violet:[238,130,238],palegoldenrod:[238,232,170],lightcoral:[240,128,128],khaki:[240,230,140],aliceblue:[240,248,255],honeydew:[240,255,240],azure:[240,255,255],sandybrown:[244,164,96],wheat:[245,222,179],beige:[245,245,220],whitesmoke:[245,245,245],mintcream:[245,255,250],ghostwhite:[248,248,255],salmon:[250,128,114],antiquewhite:[250,235,215],linen:[250,240,230],lightgoldenrodyellow:[250,250,210],oldlace:[253,245,230],red:[255,0,0],fuchsia:[255,0,255],magenta:[255,0,255],deeppink:[255,20,147],orangered:[255,69,0],tomato:[255,99,71],hotpink:[255,105,180],coral:[255,127,80],darkorange:[255,140,0],lightsalmon:[255,160,122],orange:[255,165,0],lightpink:[255,182,193],pink:[255,192,203],gold:[255,215,0],peachpuff:[255,218,185],navajowhite:[255,222,173],moccasin:[255,228,181],bisque:[255,228,196],mistyrose:[255,228,225],blanchedalmond:[255,235,205],papayawhip:[255,239,213],lavenderblush:[255,240,245],seashell:[255,245,238],cornsilk:[255,248,220],lemonchiffon:[255,250,205],floralwhite:[255,250,240],snow:[255,250,250],yellow:[255,255,0],lightyellow:[255,255,224],ivory:[255,255,240],white:[255,255,255]}},function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));class r{getContainer(){return null}setOptions(e){this._options=e}}},function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return o}));var r=i(3),n=i(2);function a(e){let t=n.fromString(e);return 36*Math.floor(t[0]*(6/256))+6*Math.floor(t[1]*(6/256))+1*Math.floor(t[2]*(6/256))+16}class o extends r.a{constructor(){super(),this._offset=[0,0],this._cursor=[-1,-1],this._lastColor=""}schedule(e){setTimeout(e,1e3/60)}setOptions(e){super.setOptions(e);let t=[e.width,e.height],i=this.computeSize();this._offset=i.map((e,i)=>Math.floor((e-t[i])/2))}clear(){e.stdout.write(`[0;48;5;${a(this._options.bg)}m[2J`)}draw(t,i){let[r,n,o,s,l]=t,h=this._offset[0]+r,c=this._offset[1]+n,u=this.computeSize();if(h<0||h>=u[0])return;if(c<0||c>=u[1])return;if(h===this._cursor[0]&&c===this._cursor[1]||(e.stdout.write(function(e,t){return`[${t+1};${e+1}H`}(h,c)),this._cursor[0]=h,this._cursor[1]=c),i&&(o||(o=" ")),!o)return;let d=function(e,t){return`[0;38;5;${a(e)};48;5;${a(t)}m`}(s,l);d!==this._lastColor&&(e.stdout.write(d),this._lastColor=d);let f=[].concat(o);e.stdout.write(f[0]),this._cursor[0]++,this._cursor[0]>=u[0]&&(this._cursor[0]=0,this._cursor[1]++)}computeFontSize(){throw new Error("Terminal backend has no notion of font size")}eventToPosition(e,t){return[e,t]}computeSize(){return[e.stdout.columns,e.stdout.rows]}}}).call(this,i(12))},function(e,t,i){var r=function(e){"use strict";var t=Object.prototype,i=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(e,t,i,r){var n=t&&t.prototype instanceof c?t:c,a=Object.create(n.prototype),o=new k(r||[]);return a._invoke=function(e,t,i){var r="suspendedStart";return function(n,a){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===n)throw a;return x()}for(i.method=n,i.arg=a;;){var o=i.delegate;if(o){var s=y(o,i);if(s){if(s===h)continue;return s}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===r)throw r="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);r="executing";var c=l(e,t,i);if("normal"===c.type){if(r=i.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(r="completed",i.method="throw",i.arg=c.arg)}}}(e,i,o),a}function l(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var h={};function c(){}function u(){}function d(){}var f={};f[n]=function(){return this};var p=Object.getPrototypeOf,g=p&&p(p(S([])));g&&g!==t&&i.call(g,n)&&(f=g);var m=d.prototype=c.prototype=Object.create(f);function _(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function b(e){var t;this._invoke=function(r,n){function a(){return new Promise((function(t,a){!function t(r,n,a,o){var s=l(e[r],e,n);if("throw"!==s.type){var h=s.arg,c=h.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,a,o)}),(function(e){t("throw",e,a,o)})):Promise.resolve(c).then((function(e){h.value=e,a(h)}),(function(e){return t("throw",e,a,o)}))}o(s.arg)}(r,n,t,a)}))}return t=t?t.then(a,a):a()}}function y(e,t){var i=e.iterator[t.method];if(void 0===i){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return h;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var r=l(i,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,h;var n=r.arg;return n?n.done?(t[e.resultName]=n.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):n:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function v(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(v,this),this.reset(!0)}function S(e){if(e){var t=e[n];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:x}}function x(){return{value:void 0,done:!0}}return u.prototype=m.constructor=d,d.constructor=u,d[o]=u.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},_(b.prototype),b.prototype[a]=function(){return this},e.AsyncIterator=b,e.async=function(t,i,r,n){var a=new b(s(t,i,r,n));return e.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},_(m),m[o]="Generator",m[n]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var i in e)t.push(i);return t.reverse(),function i(){for(;t.length;){var r=t.pop();if(r in e)return i.value=r,i.done=!1,i}return i.done=!0,i}},e.values=S,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(i,r){return o.type="throw",o.arg=e,t.next=i,r&&(t.method="next",t.arg=void 0),!!r}for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n],o=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),l=i.call(a,"finallyLoc");if(s&&l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),w(i),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;w(i)}return n}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,i){return this.delegate={iterator:S(e),resultName:t,nextLoc:i},"next"===this.method&&(this.arg=void 0),h}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,i){var r;!function(n){var a=/^\s+/,o=/\s+$/,s=0,l=n.round,h=n.min,c=n.max,u=n.random;function d(e,t){if(t=t||{},(e=e||"")instanceof d)return e;if(!(this instanceof d))return new d(e,t);var i=function(e){var t={r:0,g:0,b:0},i=1,r=null,s=null,l=null,u=!1,d=!1;"string"==typeof e&&(e=function(e){e=e.replace(a,"").replace(o,"").toLowerCase();var t,i=!1;if(R[e])e=R[e],i=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};if(t=Y.rgb.exec(e))return{r:t[1],g:t[2],b:t[3]};if(t=Y.rgba.exec(e))return{r:t[1],g:t[2],b:t[3],a:t[4]};if(t=Y.hsl.exec(e))return{h:t[1],s:t[2],l:t[3]};if(t=Y.hsla.exec(e))return{h:t[1],s:t[2],l:t[3],a:t[4]};if(t=Y.hsv.exec(e))return{h:t[1],s:t[2],v:t[3]};if(t=Y.hsva.exec(e))return{h:t[1],s:t[2],v:t[3],a:t[4]};if(t=Y.hex8.exec(e))return{r:D(t[1]),g:D(t[2]),b:D(t[3]),a:I(t[4]),format:i?"name":"hex8"};if(t=Y.hex6.exec(e))return{r:D(t[1]),g:D(t[2]),b:D(t[3]),format:i?"name":"hex"};if(t=Y.hex4.exec(e))return{r:D(t[1]+""+t[1]),g:D(t[2]+""+t[2]),b:D(t[3]+""+t[3]),a:I(t[4]+""+t[4]),format:i?"name":"hex8"};if(t=Y.hex3.exec(e))return{r:D(t[1]+""+t[1]),g:D(t[2]+""+t[2]),b:D(t[3]+""+t[3]),format:i?"name":"hex"};return!1}(e));"object"==typeof e&&(N(e.r)&&N(e.g)&&N(e.b)?(f=e.r,p=e.g,g=e.b,t={r:255*L(f,255),g:255*L(p,255),b:255*L(g,255)},u=!0,d="%"===String(e.r).substr(-1)?"prgb":"rgb"):N(e.h)&&N(e.s)&&N(e.v)?(r=G(e.s),s=G(e.v),t=function(e,t,i){e=6*L(e,360),t=L(t,100),i=L(i,100);var r=n.floor(e),a=e-r,o=i*(1-t),s=i*(1-a*t),l=i*(1-(1-a)*t),h=r%6;return{r:255*[i,s,o,o,l,i][h],g:255*[l,i,i,s,o,o][h],b:255*[o,o,l,i,i,s][h]}}(e.h,r,s),u=!0,d="hsv"):N(e.h)&&N(e.s)&&N(e.l)&&(r=G(e.s),l=G(e.l),t=function(e,t,i){var r,n,a;function o(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}if(e=L(e,360),t=L(t,100),i=L(i,100),0===t)r=n=a=i;else{var s=i<.5?i*(1+t):i+t-i*t,l=2*i-s;r=o(l,s,e+1/3),n=o(l,s,e),a=o(l,s,e-1/3)}return{r:255*r,g:255*n,b:255*a}}(e.h,r,l),u=!0,d="hsl"),e.hasOwnProperty("a")&&(i=e.a));var f,p,g;return i=E(i),{ok:u,format:e.format||d,r:h(255,c(t.r,0)),g:h(255,c(t.g,0)),b:h(255,c(t.b,0)),a:i}}(e);this._originalInput=e,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=l(100*this._a)/100,this._format=t.format||i.format,this._gradientType=t.gradientType,this._r<1&&(this._r=l(this._r)),this._g<1&&(this._g=l(this._g)),this._b<1&&(this._b=l(this._b)),this._ok=i.ok,this._tc_id=s++}function f(e,t,i){e=L(e,255),t=L(t,255),i=L(i,255);var r,n,a=c(e,t,i),o=h(e,t,i),s=(a+o)/2;if(a==o)r=n=0;else{var l=a-o;switch(n=s>.5?l/(2-a-o):l/(a+o),a){case e:r=(t-i)/l+(t<i?6:0);break;case t:r=(i-e)/l+2;break;case i:r=(e-t)/l+4}r/=6}return{h:r,s:n,l:s}}function p(e,t,i){e=L(e,255),t=L(t,255),i=L(i,255);var r,n,a=c(e,t,i),o=h(e,t,i),s=a,l=a-o;if(n=0===a?0:l/a,a==o)r=0;else{switch(a){case e:r=(t-i)/l+(t<i?6:0);break;case t:r=(i-e)/l+2;break;case i:r=(e-t)/l+4}r/=6}return{h:r,s:n,v:s}}function g(e,t,i,r){var n=[W(l(e).toString(16)),W(l(t).toString(16)),W(l(i).toString(16))];return r&&n[0].charAt(0)==n[0].charAt(1)&&n[1].charAt(0)==n[1].charAt(1)&&n[2].charAt(0)==n[2].charAt(1)?n[0].charAt(0)+n[1].charAt(0)+n[2].charAt(0):n.join("")}function m(e,t,i,r){return[W(H(r)),W(l(e).toString(16)),W(l(t).toString(16)),W(l(i).toString(16))].join("")}function _(e,t){t=0===t?0:t||10;var i=d(e).toHsl();return i.s-=t/100,i.s=B(i.s),d(i)}function b(e,t){t=0===t?0:t||10;var i=d(e).toHsl();return i.s+=t/100,i.s=B(i.s),d(i)}function y(e){return d(e).desaturate(100)}function v(e,t){t=0===t?0:t||10;var i=d(e).toHsl();return i.l+=t/100,i.l=B(i.l),d(i)}function w(e,t){t=0===t?0:t||10;var i=d(e).toRgb();return i.r=c(0,h(255,i.r-l(-t/100*255))),i.g=c(0,h(255,i.g-l(-t/100*255))),i.b=c(0,h(255,i.b-l(-t/100*255))),d(i)}function k(e,t){t=0===t?0:t||10;var i=d(e).toHsl();return i.l-=t/100,i.l=B(i.l),d(i)}function S(e,t){var i=d(e).toHsl(),r=(i.h+t)%360;return i.h=r<0?360+r:r,d(i)}function x(e){var t=d(e).toHsl();return t.h=(t.h+180)%360,d(t)}function C(e){var t=d(e).toHsl(),i=t.h;return[d(e),d({h:(i+120)%360,s:t.s,l:t.l}),d({h:(i+240)%360,s:t.s,l:t.l})]}function A(e){var t=d(e).toHsl(),i=t.h;return[d(e),d({h:(i+90)%360,s:t.s,l:t.l}),d({h:(i+180)%360,s:t.s,l:t.l}),d({h:(i+270)%360,s:t.s,l:t.l})]}function M(e){var t=d(e).toHsl(),i=t.h;return[d(e),d({h:(i+72)%360,s:t.s,l:t.l}),d({h:(i+216)%360,s:t.s,l:t.l})]}function O(e,t,i){t=t||6,i=i||30;var r=d(e).toHsl(),n=360/i,a=[d(e)];for(r.h=(r.h-(n*t>>1)+720)%360;--t;)r.h=(r.h+n)%360,a.push(d(r));return a}function T(e,t){t=t||6;for(var i=d(e).toHsv(),r=i.h,n=i.s,a=i.v,o=[],s=1/t;t--;)o.push(d({h:r,s:n,v:a})),a=(a+s)%1;return o}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,i,r=this.toRgb();return e=r.r/255,t=r.g/255,i=r.b/255,.2126*(e<=.03928?e/12.92:n.pow((e+.055)/1.055,2.4))+.7152*(t<=.03928?t/12.92:n.pow((t+.055)/1.055,2.4))+.0722*(i<=.03928?i/12.92:n.pow((i+.055)/1.055,2.4))},setAlpha:function(e){return this._a=E(e),this._roundA=l(100*this._a)/100,this},toHsv:function(){var e=p(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=p(this._r,this._g,this._b),t=l(360*e.h),i=l(100*e.s),r=l(100*e.v);return 1==this._a?"hsv("+t+", "+i+"%, "+r+"%)":"hsva("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var e=f(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=f(this._r,this._g,this._b),t=l(360*e.h),i=l(100*e.s),r=l(100*e.l);return 1==this._a?"hsl("+t+", "+i+"%, "+r+"%)":"hsla("+t+", "+i+"%, "+r+"%, "+this._roundA+")"},toHex:function(e){return g(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return function(e,t,i,r,n){var a=[W(l(e).toString(16)),W(l(t).toString(16)),W(l(i).toString(16)),W(H(r))];if(n&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1))return a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0);return a.join("")}(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:l(this._r),g:l(this._g),b:l(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+l(this._r)+", "+l(this._g)+", "+l(this._b)+")":"rgba("+l(this._r)+", "+l(this._g)+", "+l(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:l(100*L(this._r,255))+"%",g:l(100*L(this._g,255))+"%",b:l(100*L(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+l(100*L(this._r,255))+"%, "+l(100*L(this._g,255))+"%, "+l(100*L(this._b,255))+"%)":"rgba("+l(100*L(this._r,255))+"%, "+l(100*L(this._g,255))+"%, "+l(100*L(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(P[g(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+m(this._r,this._g,this._b,this._a),i=t,r=this._gradientType?"GradientType = 1, ":"";if(e){var n=d(e);i="#"+m(n._r,n._g,n._b,n._a)}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+t+",endColorstr="+i+")"},toString:function(e){var t=!!e;e=e||this._format;var i=!1,r=this._a<1&&this._a>=0;return t||!r||"hex"!==e&&"hex6"!==e&&"hex3"!==e&&"hex4"!==e&&"hex8"!==e&&"name"!==e?("rgb"===e&&(i=this.toRgbString()),"prgb"===e&&(i=this.toPercentageRgbString()),"hex"!==e&&"hex6"!==e||(i=this.toHexString()),"hex3"===e&&(i=this.toHexString(!0)),"hex4"===e&&(i=this.toHex8String(!0)),"hex8"===e&&(i=this.toHex8String()),"name"===e&&(i=this.toName()),"hsl"===e&&(i=this.toHslString()),"hsv"===e&&(i=this.toHsvString()),i||this.toHexString()):"name"===e&&0===this._a?this.toName():this.toRgbString()},clone:function(){return d(this.toString())},_applyModification:function(e,t){var i=e.apply(null,[this].concat([].slice.call(t)));return this._r=i._r,this._g=i._g,this._b=i._b,this.setAlpha(i._a),this},lighten:function(){return this._applyModification(v,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(k,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(b,arguments)},greyscale:function(){return this._applyModification(y,arguments)},spin:function(){return this._applyModification(S,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(O,arguments)},complement:function(){return this._applyCombination(x,arguments)},monochromatic:function(){return this._applyCombination(T,arguments)},splitcomplement:function(){return this._applyCombination(M,arguments)},triad:function(){return this._applyCombination(C,arguments)},tetrad:function(){return this._applyCombination(A,arguments)}},d.fromRatio=function(e,t){if("object"==typeof e){var i={};for(var r in e)e.hasOwnProperty(r)&&(i[r]="a"===r?e[r]:G(e[r]));e=i}return d(e,t)},d.equals=function(e,t){return!(!e||!t)&&d(e).toRgbString()==d(t).toRgbString()},d.random=function(){return d.fromRatio({r:u(),g:u(),b:u()})},d.mix=function(e,t,i){i=0===i?0:i||50;var r=d(e).toRgb(),n=d(t).toRgb(),a=i/100;return d({r:(n.r-r.r)*a+r.r,g:(n.g-r.g)*a+r.g,b:(n.b-r.b)*a+r.b,a:(n.a-r.a)*a+r.a})},d.readability=function(e,t){var i=d(e),r=d(t);return(n.max(i.getLuminance(),r.getLuminance())+.05)/(n.min(i.getLuminance(),r.getLuminance())+.05)},d.isReadable=function(e,t,i){var r,n,a=d.readability(e,t);switch(n=!1,(r=function(e){var t,i;t=((e=e||{level:"AA",size:"small"}).level||"AA").toUpperCase(),i=(e.size||"small").toLowerCase(),"AA"!==t&&"AAA"!==t&&(t="AA");"small"!==i&&"large"!==i&&(i="small");return{level:t,size:i}}(i)).level+r.size){case"AAsmall":case"AAAlarge":n=a>=4.5;break;case"AAlarge":n=a>=3;break;case"AAAsmall":n=a>=7}return n},d.mostReadable=function(e,t,i){var r,n,a,o,s=null,l=0;n=(i=i||{}).includeFallbackColors,a=i.level,o=i.size;for(var h=0;h<t.length;h++)(r=d.readability(e,t[h]))>l&&(l=r,s=d(t[h]));return d.isReadable(e,s,{level:a,size:o})||!n?s:(i.includeFallbackColors=!1,d.mostReadable(e,["#fff","#000"],i))};var R=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=d.hexNames=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}(R);function E(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function L(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var i=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=h(t,c(0,parseFloat(e))),i&&(e=parseInt(e*t,10)/100),n.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function B(e){return h(1,c(0,e))}function D(e){return parseInt(e,16)}function W(e){return 1==e.length?"0"+e:""+e}function G(e){return e<=1&&(e=100*e+"%"),e}function H(e){return n.round(255*parseFloat(e)).toString(16)}function I(e){return D(e)/255}var F,j,z,Y=(j="[\\s|\\(]+("+(F="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+F+")[,|\\s]+("+F+")\\s*\\)?",z="[\\s|\\(]+("+F+")[,|\\s]+("+F+")[,|\\s]+("+F+")[,|\\s]+("+F+")\\s*\\)?",{CSS_UNIT:new RegExp(F),rgb:new RegExp("rgb"+j),rgba:new RegExp("rgba"+z),hsl:new RegExp("hsl"+j),hsla:new RegExp("hsla"+z),hsv:new RegExp("hsv"+j),hsva:new RegExp("hsva"+z),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function N(e){return!!Y.CSS_UNIT.exec(e)}e.exports?e.exports=d:void 0===(r=function(){return d}.call(t,i,t,e))||(e.exports=r)}(Math)},,function(e,t,i){var r=i(9),n=i(10);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var a={insert:"head",singleton:!1},o=(r(n,a),n.locals?n.locals:{});e.exports=o},function(e,t,i){"use strict";var r,n=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),o=[];function s(e){for(var t=-1,i=0;i<o.length;i++)if(o[i].identifier===e){t=i;break}return t}function l(e,t){for(var i={},r=[],n=0;n<e.length;n++){var a=e[n],l=t.base?a[0]+t.base:a[0],h=i[l]||0,c="".concat(l," ").concat(h);i[l]=h+1;var u=s(c),d={css:a[1],media:a[2],sourceMap:a[3]};-1!==u?(o[u].references++,o[u].updater(d)):o.push({identifier:c,updater:m(d,t),references:1}),r.push(c)}return r}function h(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var n=i.nc;n&&(r.nonce=n)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var o=a(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function d(e,t,i,r){var n=i?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=u(t,n);else{var a=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function f(e,t,i){var r=i.css,n=i.media,a=i.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,g=0;function m(e,t){var i,r,n;if(t.singleton){var a=g++;i=p||(p=h(t)),r=d.bind(null,i,a,!1),n=d.bind(null,i,a,!0)}else i=h(t),r=f.bind(null,i,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var i=l(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<i.length;r++){var n=s(i[r]);o[n].references--}for(var a=l(e,t),h=0;h<i.length;h++){var c=s(i[h]);0===o[c].references&&(o[c].updater(),o.splice(c,1))}i=a}}}},function(e,t,i){(t=i(11)(!1)).push([e.i,"canvas{width:100%;height:auto;position:fixed;top:0;left:0}\n",""]),e.exports=t},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",r=e[3];if(!r)return i;if(t&&"function"==typeof btoa){var n=(o=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(l," */")),a=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[i].concat(a).concat([n]).join("\n")}var o,s,l;return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var a=0;a<this.length;a++){var o=this[a][0];null!=o&&(n[o]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&n[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},function(e,t){var i,r,n=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var l,h=[],c=!1,u=-1;function d(){c&&l&&(c=!1,l.length?h=l.concat(h):u=-1,h.length&&f())}function f(){if(!c){var e=s(d);c=!0;for(var t=h.length;t;){for(l=h,h=[];++u<t;)l&&l[u].run();u=-1,t=h.length}l=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];h.push(new p(e,t)),1!==h.length||c||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(e,t,i){"use strict";i.r(t);var r={};i.r(r),i.d(r,"TYPE_TEXT",(function(){return v})),i.d(r,"TYPE_NEWLINE",(function(){return w})),i.d(r,"TYPE_FG",(function(){return k})),i.d(r,"TYPE_BG",(function(){return S})),i.d(r,"measure",(function(){return x})),i.d(r,"tokenize",(function(){return C}));i(5),i(8);var n=i(0),a=i(3);class o extends a.a{constructor(){super(),this._ctx=document.createElement("canvas").getContext("2d")}schedule(e){requestAnimationFrame(e)}getContainer(){return this._ctx.canvas}setOptions(e){super.setOptions(e);const t=`${e.fontStyle?`${e.fontStyle} `:""} ${e.fontSize}px ${e.fontFamily}`;this._ctx.font=t,this._updateSize(),this._ctx.font=t,this._ctx.textAlign="center",this._ctx.textBaseline="middle"}clear(){this._ctx.fillStyle=this._options.bg,this._ctx.fillRect(0,0,this._ctx.canvas.width,this._ctx.canvas.height)}eventToPosition(e,t){let i=this._ctx.canvas,r=i.getBoundingClientRect();return e-=r.left,t-=r.top,e*=i.width/r.width,t*=i.height/r.height,e<0||t<0||e>=i.width||t>=i.height?[-1,-1]:this._normalizedEventToPosition(e,t)}}var s=i(1);class l extends o{constructor(){super(),this._spacingX=0,this._spacingY=0,this._hexSize=0}draw(e,t){let[i,r,n,a,o]=e,s=[(i+1)*this._spacingX,r*this._spacingY+this._hexSize];if(this._options.transpose&&s.reverse(),t&&(this._ctx.fillStyle=o,this._fill(s[0],s[1])),!n)return;this._ctx.fillStyle=a;let l=[].concat(n);for(let e=0;e<l.length;e++)this._ctx.fillText(l[e],s[0],Math.ceil(s[1]))}computeSize(e,t){return this._options.transpose&&(e+=t,e-=t=e-t),[Math.floor(e/this._spacingX)-1,Math.floor((t-2*this._hexSize)/this._spacingY+1)]}computeFontSize(e,t){this._options.transpose&&(e+=t,e-=t=e-t);let i=2*e/((this._options.width+1)*Math.sqrt(3))-1,r=t/(2+1.5*(this._options.height-1)),n=Math.min(i,r),a=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let o=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=a;let s=o/100;n=Math.floor(n)+1;let l=2*n/(this._options.spacing*(1+s/Math.sqrt(3)));return Math.ceil(l)-1}_normalizedEventToPosition(e,t){let i;this._options.transpose?(e+=t,e-=t=e-t,i=this._ctx.canvas.width):i=this._ctx.canvas.height;let r=i/this._options.height;return t=Math.floor(t/r),Object(s.mod)(t,2)?(e-=this._spacingX,e=1+2*Math.floor(e/(2*this._spacingX))):e=2*Math.floor(e/(2*this._spacingX)),[e,t]}_fill(e,t){let i=this._hexSize,r=this._options.border;const n=this._ctx;n.beginPath(),this._options.transpose?(n.moveTo(e-i+r,t),n.lineTo(e-i/2+r,t+this._spacingX-r),n.lineTo(e+i/2-r,t+this._spacingX-r),n.lineTo(e+i-r,t),n.lineTo(e+i/2-r,t-this._spacingX+r),n.lineTo(e-i/2+r,t-this._spacingX+r),n.lineTo(e-i+r,t)):(n.moveTo(e,t-i+r),n.lineTo(e+this._spacingX-r,t-i/2+r),n.lineTo(e+this._spacingX-r,t+i/2-r),n.lineTo(e,t+i-r),n.lineTo(e-this._spacingX+r,t+i/2-r),n.lineTo(e-this._spacingX+r,t-i/2+r),n.lineTo(e,t-i+r)),n.fill()}_updateSize(){const e=this._options,t=Math.ceil(this._ctx.measureText("W").width);let i,r;this._hexSize=Math.floor(e.spacing*(e.fontSize+t/Math.sqrt(3))/2),this._spacingX=this._hexSize*Math.sqrt(3)/2,this._spacingY=1.5*this._hexSize,e.transpose?(i="height",r="width"):(i="width",r="height"),this._ctx.canvas[i]=Math.ceil((e.width+1)*this._spacingX),this._ctx.canvas[r]=Math.ceil((e.height-1)*this._spacingY+2*this._hexSize)}}class h extends o{constructor(){super(),this._spacingX=0,this._spacingY=0,this._canvasCache={}}setOptions(e){super.setOptions(e),this._canvasCache={}}draw(e,t){h.cache?this._drawWithCache(e):this._drawNoCache(e,t)}_drawWithCache(e){let t,[i,r,n,a,o]=e,s=""+n+a+o;if(s in this._canvasCache)t=this._canvasCache[s];else{let e=this._options.border;t=document.createElement("canvas");let i=t.getContext("2d");if(t.width=this._spacingX,t.height=this._spacingY,i.fillStyle=o,i.fillRect(e,e,t.width-e,t.height-e),n){i.fillStyle=a,i.font=this._ctx.font,i.textAlign="center",i.textBaseline="middle";let e=[].concat(n);for(let t=0;t<e.length;t++)i.fillText(e[t],this._spacingX/2,Math.ceil(this._spacingY/2))}this._canvasCache[s]=t}this._ctx.drawImage(t,i*this._spacingX,r*this._spacingY)}_drawNoCache(e,t){let[i,r,n,a,o]=e;if(t){let e=this._options.border;this._ctx.fillStyle=o,this._ctx.fillRect(i*this._spacingX+e,r*this._spacingY+e,this._spacingX-e,this._spacingY-e)}if(!n)return;this._ctx.fillStyle=a;let s=[].concat(n);for(let e=0;e<s.length;e++)this._ctx.fillText(s[e],(i+.5)*this._spacingX,Math.ceil((r+.5)*this._spacingY))}computeSize(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}computeFontSize(e,t){let i=Math.floor(e/this._options.width),r=Math.floor(t/this._options.height),n=this._ctx.font;this._ctx.font="100px "+this._options.fontFamily;let a=Math.ceil(this._ctx.measureText("W").width);this._ctx.font=n;let o=a/100*r/i;return o>1&&(r=Math.floor(r/o)),Math.floor(r/this._options.spacing)}_normalizedEventToPosition(e,t){return[Math.floor(e/this._spacingX),Math.floor(t/this._spacingY)]}_updateSize(){const e=this._options,t=Math.ceil(this._ctx.measureText("W").width);this._spacingX=Math.ceil(e.spacing*t),this._spacingY=Math.ceil(e.spacing*e.fontSize),e.forceSquareRatio&&(this._spacingX=this._spacingY=Math.max(this._spacingX,this._spacingY)),this._ctx.canvas.width=e.width*this._spacingX,this._ctx.canvas.height=e.height*this._spacingY}}h.cache=!1;class c extends o{constructor(){super(),this._colorCanvas=document.createElement("canvas")}draw(e,t){let[i,r,n,a,o]=e,s=this._options.tileWidth,l=this._options.tileHeight;if(t&&(this._options.tileColorize?this._ctx.clearRect(i*s,r*l,s,l):(this._ctx.fillStyle=o,this._ctx.fillRect(i*s,r*l,s,l))),!n)return;let h=[].concat(n),c=[].concat(a),u=[].concat(o);for(let e=0;e<h.length;e++){let t=this._options.tileMap[h[e]];if(!t)throw new Error(`Char "${h[e]}" not found in tileMap`);if(this._options.tileColorize){let n=this._colorCanvas,a=n.getContext("2d");a.globalCompositeOperation="source-over",a.clearRect(0,0,s,l);let o=c[e],h=u[e];a.drawImage(this._options.tileSet,t[0],t[1],s,l,0,0,s,l),"transparent"!=o&&(a.fillStyle=o,a.globalCompositeOperation="source-atop",a.fillRect(0,0,s,l)),"transparent"!=h&&(a.fillStyle=h,a.globalCompositeOperation="destination-over",a.fillRect(0,0,s,l)),this._ctx.drawImage(n,i*s,r*l,s,l)}else this._ctx.drawImage(this._options.tileSet,t[0],t[1],s,l,i*s,r*l,s,l)}}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){const e=this._options;this._ctx.canvas.width=e.width*e.tileWidth,this._ctx.canvas.height=e.height*e.tileHeight,this._colorCanvas.width=e.tileWidth,this._colorCanvas.height=e.tileHeight}}var u=i(2);class d extends a.a{static isSupported(){return!!document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0})}constructor(){super(),this._uniforms={};try{this._gl=this._initWebGL()}catch(e){alert(e.message)}}schedule(e){requestAnimationFrame(e)}getContainer(){return this._gl.canvas}setOptions(e){super.setOptions(e),this._updateSize();let t=this._options.tileSet;t&&"complete"in t&&!t.complete?t.addEventListener("load",()=>this._updateTexture(t)):this._updateTexture(t)}draw(e,t){const i=this._gl,r=this._options;let[n,a,o,s,l]=e,h=i.canvas.height-(a+1)*r.tileHeight;if(i.scissor(n*r.tileWidth,h,r.tileWidth,r.tileHeight),t&&(r.tileColorize?i.clearColor(0,0,0,0):i.clearColor(..._(l)),i.clear(i.COLOR_BUFFER_BIT)),!o)return;let c=[].concat(o),u=[].concat(l),d=[].concat(s);i.uniform2fv(this._uniforms.targetPosRel,[n,a]);for(let e=0;e<c.length;e++){let t=this._options.tileMap[c[e]];if(!t)throw new Error(`Char "${c[e]}" not found in tileMap`);i.uniform1f(this._uniforms.colorize,r.tileColorize?1:0),i.uniform2fv(this._uniforms.tilesetPosAbs,t),r.tileColorize&&(i.uniform4fv(this._uniforms.tint,_(d[e])),i.uniform4fv(this._uniforms.bg,_(u[e]))),i.drawArrays(i.TRIANGLE_STRIP,0,4)}}clear(){const e=this._gl;e.clearColor(..._(this._options.bg)),e.scissor(0,0,e.canvas.width,e.canvas.height),e.clear(e.COLOR_BUFFER_BIT)}computeSize(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}computeFontSize(){throw new Error("Tile backend does not understand font size")}eventToPosition(e,t){let i=this._gl.canvas,r=i.getBoundingClientRect();return e-=r.left,t-=r.top,e*=i.width/r.width,t*=i.height/r.height,e<0||t<0||e>=i.width||t>=i.height?[-1,-1]:this._normalizedEventToPosition(e,t)}_initWebGL(){let e=document.createElement("canvas").getContext("webgl2",{preserveDrawingBuffer:!0});window.gl=e;let t=function(e,t,i){const r=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(r)||"");const n=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(n,i),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(n)||"");const a=e.createProgram();if(e.attachShader(a,r),e.attachShader(a,n),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(a)||"");return a}(e,p,g);return e.useProgram(t),function(e){const t=new Float32Array([0,0,1,0,0,1,1,1]),i=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,i),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0)}(e),f.forEach(i=>this._uniforms[i]=e.getUniformLocation(t,i)),this._program=t,e.enable(e.BLEND),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA),e.enable(e.SCISSOR_TEST),e}_normalizedEventToPosition(e,t){return[Math.floor(e/this._options.tileWidth),Math.floor(t/this._options.tileHeight)]}_updateSize(){const e=this._gl,t=this._options,i=[t.width*t.tileWidth,t.height*t.tileHeight];e.canvas.width=i[0],e.canvas.height=i[1],e.viewport(0,0,i[0],i[1]),e.uniform2fv(this._uniforms.tileSize,[t.tileWidth,t.tileHeight]),e.uniform2fv(this._uniforms.targetSize,i)}_updateTexture(e){!function(e,t){let i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)}(this._gl,e)}}const f=["targetPosRel","tilesetPosAbs","tileSize","targetSize","colorize","bg","tint"],p="\n#version 300 es\n\nin vec2 tilePosRel;\nout vec2 tilesetPosPx;\n\nuniform vec2 tilesetPosAbs;\nuniform vec2 tileSize;\nuniform vec2 targetSize;\nuniform vec2 targetPosRel;\n\nvoid main() {\n\tvec2 targetPosPx = (targetPosRel + tilePosRel) * tileSize;\n\tvec2 targetPosNdc = ((targetPosPx / targetSize)-0.5)*2.0;\n\ttargetPosNdc.y *= -1.0;\n\n\tgl_Position = vec4(targetPosNdc, 0.0, 1.0);\n\ttilesetPosPx = tilesetPosAbs + tilePosRel * tileSize;\n}".trim(),g="\n#version 300 es\nprecision highp float;\n\nin vec2 tilesetPosPx;\nout vec4 fragColor;\nuniform sampler2D image;\nuniform bool colorize;\nuniform vec4 bg;\nuniform vec4 tint;\n\nvoid main() {\n\tfragColor = vec4(0, 0, 0, 1);\n\n\tvec4 texel = texelFetch(image, ivec2(tilesetPosPx), 0);\n\n\tif (colorize) {\n\t\ttexel.rgb = tint.a * tint.rgb + (1.0-tint.a) * texel.rgb;\n\t\tfragColor.rgb = texel.a*texel.rgb + (1.0-texel.a)*bg.rgb;\n\t\tfragColor.a = texel.a + (1.0-texel.a)*bg.a;\n\t} else {\n\t\tfragColor = texel;\n\t}\n}".trim();let m={};function _(e){if(!(e in m)){let t;if("transparent"==e)t=[0,0,0,0];else if(e.indexOf("rgba")>-1){t=(e.match(/[\d.]+/g)||[]).map(Number);for(let e=0;e<3;e++)t[e]=t[e]/255}else t=u.fromString(e).map(e=>e/255),t.push(1);m[e]=t}return m[e]}var b=i(4);const y=/%([bc]){([^}]*)}/g,v=0,w=1,k=2,S=3;function x(e,t){let i={width:0,height:1},r=C(e,t),n=0;for(let e=0;e<r.length;e++){let t=r[e];switch(t.type){case v:n+=t.value.length;break;case w:i.height++,i.width=Math.max(i.width,n),n=0}}return i.width=Math.max(i.width,n),i}function C(e,t){let i=[],r=0;e.replace(y,(function(t,n,a,o){let s=e.substring(r,o);return s.length&&i.push({type:v,value:s}),i.push({type:"c"==n?k:S,value:a.trim()}),r=o+t.length,""}));let n=e.substring(r);return n.length&&i.push({type:v,value:n}),function(e,t){t||(t=1/0);let i=0,r=0,n=-1;for(;i<e.length;){let a=e[i];if(a.type==w&&(r=0,n=-1),a.type!=v){i++;continue}for(;0==r&&" "==a.value.charAt(0);)a.value=a.value.substring(1);let o=a.value.indexOf("\n");if(-1!=o){a.value=A(e,i,o,!0);let t=a.value.split("");for(;t.length&&" "==t[t.length-1];)t.pop();a.value=t.join("")}if(a.value.length){if(r+a.value.length>t){let o=-1;for(;;){let e=a.value.indexOf(" ",o+1);if(-1==e)break;if(r+e>t)break;o=e}if(-1!=o)a.value=A(e,i,o,!0);else if(-1!=n){let t=e[n],r=t.value.lastIndexOf(" ");t.value=A(e,n,r,!0),i=n}else a.value=A(e,i,t-r,!1)}else r+=a.value.length,-1!=a.value.indexOf(" ")&&(n=i);i++}else e.splice(i,1)}e.push({type:w});let a=null;for(let t=0;t<e.length;t++){let i=e[t];switch(i.type){case v:a=i;break;case w:if(a){let e=a.value.split("");for(;e.length&&" "==e[e.length-1];)e.pop();a.value=e.join("")}a=null}}return e.pop(),e}(i,t)}function A(e,t,i,r){let n={type:w},a={type:v,value:e[t].value.substring(i+(r?1:0))};return e.splice(t+1,0,n,a),e[t].value.substring(0,i)}const M={4:[[0,-1],[1,0],[0,1],[-1,0]],8:[[0,-1],[1,-1],[1,0],[1,1],[0,1],[-1,1],[-1,0],[-1,-1]],6:[[-1,-1],[1,-1],[2,0],[1,1],[-1,1],[-2,0]]},O={hex:l,rect:h,tile:c,"tile-gl":d,term:b.a},T={width:80,height:25,transpose:!1,layout:"rect",fontSize:15,spacing:1,border:0,forceSquareRatio:!1,fontFamily:"monospace",fontStyle:"",fg:"#ccc",bg:"#000",tileWidth:32,tileHeight:32,tileMap:{},tileSet:null,tileColorize:!1};class R{constructor(e={}){this._data={},this._dirty=!1,this._options={},e=Object.assign({},T,e),this.setOptions(e),this.DEBUG=this.DEBUG.bind(this),this._tick=this._tick.bind(this),this._backend.schedule(this._tick)}DEBUG(e,t,i){let r=[this._options.bg,this._options.fg];this.draw(e,t,null,null,r[i%r.length])}clear(){this._data={},this._dirty=!0}setOptions(e){if(Object.assign(this._options,e),e.width||e.height||e.fontSize||e.fontFamily||e.spacing||e.layout){if(e.layout){let t=O[e.layout];this._backend=new t}this._backend.setOptions(this._options),this._dirty=!0}return this}getOptions(){return this._options}getContainer(){return this._backend.getContainer()}computeSize(e,t){return this._backend.computeSize(e,t)}computeFontSize(e,t){return this._backend.computeFontSize(e,t)}computeTileSize(e,t){return[Math.floor(e/this._options.width),Math.floor(t/this._options.height)]}eventToPosition(e){let t,i;return"touches"in e?(t=e.touches[0].clientX,i=e.touches[0].clientY):(t=e.clientX,i=e.clientY),this._backend.eventToPosition(t,i)}draw(e,t,i,r,n){r||(r=this._options.fg),n||(n=this._options.bg);let a=`${e},${t}`;this._data[a]=[e,t,i,r,n],!0!==this._dirty&&(this._dirty||(this._dirty={}),this._dirty[a]=!0)}drawText(e,t,i,r){let n=null,a=null,o=e,s=t,l=1;r||(r=this._options.width-e);let h=C(i,r);for(;h.length;){let t=h.shift();switch(t.type){case v:let i=!1,r=!1,h=!1,c=!1;for(let e=0;e<t.value.length;e++){let l=t.value.charCodeAt(e),u=t.value.charAt(e);h=l>65280&&l<65377||l>65500&&l<65512||l>65518,i=32==u.charCodeAt(0)||12288==u.charCodeAt(0),!c||h||i||o++,h&&!r&&o++,this.draw(o++,s,u,n,a),r=i,c=h}break;case k:n=t.value||null;break;case S:a=t.value||null;break;case w:o=e,s++,l++}}return l}_tick(){if(this._backend.schedule(this._tick),this._dirty){if(!0===this._dirty){this._backend.clear();for(let e in this._data)this._draw(e,!1)}else for(let e in this._dirty)this._draw(e,!0);this._dirty=!1}}_draw(e,t){let i=this._data[e];i[4]!=this._options.bg&&(t=!0),this._backend.draw(i,t)}}R.Rect=h,R.Hex=l,R.Tile=c,R.TileGL=d,R.Term=b.a;class P{constructor(){this._time=0,this._events=[],this._eventTimes=[]}getTime(){return this._time}clear(){return this._events=[],this._eventTimes=[],this}add(e,t){let i=this._events.length;for(let e=0;e<this._eventTimes.length;e++)if(this._eventTimes[e]>t){i=e;break}this._events.splice(i,0,e),this._eventTimes.splice(i,0,t)}get(){if(!this._events.length)return null;let e=this._eventTimes.splice(0,1)[0];if(e>0){this._time+=e;for(let t=0;t<this._eventTimes.length;t++)this._eventTimes[t]-=e}return this._events.splice(0,1)[0]}getEventTime(e){let t=this._events.indexOf(e);if(-1!=t)return this._eventTimes[t]}remove(e){let t=this._events.indexOf(e);return-1!=t&&(this._remove(t),!0)}_remove(e){this._events.splice(e,1),this._eventTimes.splice(e,1)}}class E{constructor(){this._queue=new P,this._repeat=[],this._current=null}getTime(){return this._queue.getTime()}add(e,t){return t&&this._repeat.push(e),this}getTimeOf(e){return this._queue.getEventTime(e)}clear(){return this._queue.clear(),this._repeat=[],this._current=null,this}remove(e){let t=this._queue.remove(e),i=this._repeat.indexOf(e);return-1!=i&&this._repeat.splice(i,1),this._current==e&&(this._current=null),t}next(){return this._current=this._queue.get(),this._current}}var L={Simple:class extends E{add(e,t){return this._queue.add(e,0),super.add(e,t)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,0),super.next()}},Speed:class extends E{add(e,t,i){return this._queue.add(e,void 0!==i?i:1/e.getSpeed()),super.add(e,t)}next(){return this._current&&-1!=this._repeat.indexOf(this._current)&&this._queue.add(this._current,1/this._current.getSpeed()),super.next()}},Action:class extends E{constructor(){super(),this._defaultDuration=1,this._duration=this._defaultDuration}add(e,t,i){return this._queue.add(e,i||this._defaultDuration),super.add(e,t)}clear(){return this._duration=this._defaultDuration,super.clear()}remove(e){return e==this._current&&(this._duration=this._defaultDuration),super.remove(e)}next(){return null!==this._current&&-1!=this._repeat.indexOf(this._current)&&(this._queue.add(this._current,this._duration||this._defaultDuration),this._duration=this._defaultDuration),super.next()}setDuration(e){return this._current&&(this._duration=e),this}}};class B{constructor(e,t={}){this._lightPasses=e,this._options=Object.assign({topology:8},t)}_getCircle(e,t,i){let r,n,a,o=[];switch(this._options.topology){case 4:n=1,a=[0,1],r=[M[8][7],M[8][1],M[8][3],M[8][5]];break;case 6:r=M[6],n=1,a=[-1,1];break;case 8:r=M[4],n=2,a=[-1,1];break;default:throw new Error("Incorrect topology for FOV computation")}let s=e+a[0]*i,l=t+a[1]*i;for(let e=0;e<r.length;e++)for(let t=0;t<i*n;t++)o.push([s,l]),s+=r[e][0],l+=r[e][1];return o}}const D=[[-1,0,0,1],[0,-1,1,0],[0,-1,-1,0],[-1,0,0,-1],[1,0,0,-1],[0,1,-1,0],[0,1,1,0],[1,0,0,1]];var W={DiscreteShadowcasting:class extends B{compute(e,t,i,r){if(r(e,t,0,1),!this._lightPasses(e,t))return;let n,a,o,s,l,h=[];for(let c=1;c<=i;c++){let i=this._getCircle(e,t,c),u=360/i.length;for(let e=0;e<i.length;e++)if(o=i[e][0],s=i[e][1],n=u*(e-.5),a=n+u,l=!this._lightPasses(o,s),this._visibleCoords(Math.floor(n),Math.ceil(a),l,h)&&r(o,s,c,1),2==h.length&&0==h[0]&&360==h[1])return}}_visibleCoords(e,t,i,r){if(e<0){let n=this._visibleCoords(0,t,i,r),a=this._visibleCoords(360+e,360,i,r);return n||a}let n=0;for(;n<r.length&&r[n]<e;)n++;if(n==r.length)return i&&r.push(e,t),!0;let a=0;if(n%2){for(;n<r.length&&r[n]<t;)n++,a++;return 0!=a&&(i&&(a%2?r.splice(n-a,a,t):r.splice(n-a,a)),!0)}for(;n<r.length&&r[n]<t;)n++,a++;return(e!=r[n-a]||1!=a)&&(i&&(a%2?r.splice(n-a,a,e):r.splice(n-a,a,e,t)),!0)}},PreciseShadowcasting:class extends B{compute(e,t,i,r){if(r(e,t,0,1),!this._lightPasses(e,t))return;let n,a,o,s,l,h,c=[];for(let u=1;u<=i;u++){let i=this._getCircle(e,t,u),d=i.length;for(let e=0;e<d;e++)if(n=i[e][0],a=i[e][1],s=[e?2*e-1:2*d-1,2*d],l=[2*e+1,2*d],o=!this._lightPasses(n,a),h=this._checkVisibility(s,l,o,c),h&&r(n,a,u,h),2==c.length&&0==c[0][0]&&c[1][0]==c[1][1])return}}_checkVisibility(e,t,i,r){if(e[0]>t[0]){return(this._checkVisibility(e,[e[1],e[1]],i,r)+this._checkVisibility([0,1],t,i,r))/2}let n=0,a=!1;for(;n<r.length;){let t=r[n],i=t[0]*e[1]-e[0]*t[1];if(i>=0){0!=i||n%2||(a=!0);break}n++}let o=r.length,s=!1;for(;o--;){let e=r[o],i=t[0]*e[1]-e[0]*t[1];if(i>=0){0==i&&o%2&&(s=!0);break}}let l,h=!0;if(n==o&&(a||s)?h=!1:a&&s&&n+1==o&&o%2?h=!1:n>o&&n%2&&(h=!1),!h)return 0;let c=o-n+1;if(c%2)if(n%2){let e=r[n];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),i&&r.splice(n,c,t)}else{let t=r[o];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),i&&r.splice(n,c,e)}else{if(!(n%2))return i&&r.splice(n,c,e,t),1;{let e=r[n],t=r[o];l=(t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]),i&&r.splice(n,c)}}return l/((t[0]*e[1]-e[0]*t[1])/(e[1]*t[1]))}},RecursiveShadowcasting:class extends B{compute(e,t,i,r){r(e,t,0,1);for(let n=0;n<D.length;n++)this._renderOctant(e,t,D[n],i,r)}compute180(e,t,i,r,n){n(e,t,0,1);let a=(r-1+8)%8,o=(r-2+8)%8,s=(r+1+8)%8;this._renderOctant(e,t,D[o],i,n),this._renderOctant(e,t,D[a],i,n),this._renderOctant(e,t,D[r],i,n),this._renderOctant(e,t,D[s],i,n)}compute90(e,t,i,r,n){n(e,t,0,1);let a=(r-1+8)%8;this._renderOctant(e,t,D[r],i,n),this._renderOctant(e,t,D[a],i,n)}_renderOctant(e,t,i,r,n){this._castVisibility(e,t,1,1,0,r+1,i[0],i[1],i[2],i[3],n)}_castVisibility(e,t,i,r,n,a,o,s,l,h,c){if(!(r<n))for(let u=i;u<=a;u++){let i=-u-1,d=-u,f=!1,p=0;for(;i<=0;){i+=1;let g=e+i*o+d*s,m=t+i*l+d*h,_=(i-.5)/(d+.5),b=(i+.5)/(d-.5);if(!(b>r)){if(_<n)break;if(i*i+d*d<a*a&&c(g,m,u,1),f){if(!this._lightPasses(g,m)){p=b;continue}f=!1,r=p}else!this._lightPasses(g,m)&&u<a&&(f=!0,this._castVisibility(e,t,u+1,r,_,a,o,s,l,h,c),p=b)}}if(f)break}}}};class G{constructor(e=80,t=25){this._width=e,this._height=t}_fillMap(e){let t=[];for(let i=0;i<this._width;i++){t.push([]);for(let r=0;r<this._height;r++)t[i].push(e)}return t}}class H extends G{constructor(e,t){super(e,t),this._rooms=[],this._corridors=[]}getRooms(){return this._rooms}getCorridors(){return this._corridors}}class I{}class F extends I{constructor(e,t,i,r,n,a){super(),this._x1=e,this._y1=t,this._x2=i,this._y2=r,this._doors={},void 0!==n&&void 0!==a&&this.addDoor(n,a)}static createRandomAt(e,t,i,r,a){let o=a.roomWidth[0],s=a.roomWidth[1],l=n.a.getUniformInt(o,s);o=a.roomHeight[0],s=a.roomHeight[1];let h=n.a.getUniformInt(o,s);if(1==i){let i=t-Math.floor(n.a.getUniform()*h);return new this(e+1,i,e+l,i+h-1,e,t)}if(-1==i){let i=t-Math.floor(n.a.getUniform()*h);return new this(e-l,i,e-1,i+h-1,e,t)}if(1==r){let i=e-Math.floor(n.a.getUniform()*l);return new this(i,t+1,i+l-1,t+h,e,t)}if(-1==r){let i=e-Math.floor(n.a.getUniform()*l);return new this(i,t-h,i+l-1,t-1,e,t)}throw new Error("dx or dy must be 1 or -1")}static createRandomCenter(e,t,i){let r=i.roomWidth[0],a=i.roomWidth[1],o=n.a.getUniformInt(r,a);r=i.roomHeight[0],a=i.roomHeight[1];let s=n.a.getUniformInt(r,a),l=e-Math.floor(n.a.getUniform()*o),h=t-Math.floor(n.a.getUniform()*s);return new this(l,h,l+o-1,h+s-1)}static createRandom(e,t,i){let r=i.roomWidth[0],a=i.roomWidth[1],o=n.a.getUniformInt(r,a);r=i.roomHeight[0],a=i.roomHeight[1];let s=n.a.getUniformInt(r,a),l=e-o-1,h=t-s-1,c=1+Math.floor(n.a.getUniform()*l),u=1+Math.floor(n.a.getUniform()*h);return new this(c,u,c+o-1,u+s-1)}addDoor(e,t){return this._doors[e+","+t]=1,this}getDoors(e){for(let t in this._doors){let i=t.split(",");e(parseInt(i[0]),parseInt(i[1]))}return this}clearDoors(){return this._doors={},this}addDoors(e){let t=this._x1-1,i=this._x2+1,r=this._y1-1,n=this._y2+1;for(let a=t;a<=i;a++)for(let o=r;o<=n;o++)a!=t&&a!=i&&o!=r&&o!=n||e(a,o)||this.addDoor(a,o);return this}debug(){console.log("room",this._x1,this._y1,this._x2,this._y2)}isValid(e,t){let i=this._x1-1,r=this._x2+1,n=this._y1-1,a=this._y2+1;for(let o=i;o<=r;o++)for(let s=n;s<=a;s++)if(o==i||o==r||s==n||s==a){if(!e(o,s))return!1}else if(!t(o,s))return!1;return!0}create(e){let t=this._x1-1,i=this._x2+1,r=this._y1-1,n=this._y2+1,a=0;for(let o=t;o<=i;o++)for(let s=r;s<=n;s++)a=o+","+s in this._doors?2:o==t||o==i||s==r||s==n?1:0,e(o,s,a)}getCenter(){return[Math.round((this._x1+this._x2)/2),Math.round((this._y1+this._y2)/2)]}getLeft(){return this._x1}getRight(){return this._x2}getTop(){return this._y1}getBottom(){return this._y2}}class j extends I{constructor(e,t,i,r){super(),this._startX=e,this._startY=t,this._endX=i,this._endY=r,this._endsWithAWall=!0}static createRandomAt(e,t,i,r,a){let o=a.corridorLength[0],s=a.corridorLength[1],l=n.a.getUniformInt(o,s);return new this(e,t,e+i*l,t+r*l)}debug(){console.log("corridor",this._startX,this._startY,this._endX,this._endY)}isValid(e,t){let i=this._startX,r=this._startY,n=this._endX-i,a=this._endY-r,o=1+Math.max(Math.abs(n),Math.abs(a));n&&(n/=Math.abs(n)),a&&(a/=Math.abs(a));let s=a,l=-n,h=!0;for(let c=0;c<o;c++){let u=i+c*n,d=r+c*a;if(t(u,d)||(h=!1),e(u+s,d+l)||(h=!1),e(u-s,d-l)||(h=!1),!h){o=c,this._endX=u-n,this._endY=d-a;break}}if(0==o)return!1;if(1==o&&e(this._endX+n,this._endY+a))return!1;let c=!e(this._endX+n+s,this._endY+a+l),u=!e(this._endX+n-s,this._endY+a-l);return this._endsWithAWall=e(this._endX+n,this._endY+a),!c&&!u||!this._endsWithAWall}create(e){let t=this._startX,i=this._startY,r=this._endX-t,n=this._endY-i,a=1+Math.max(Math.abs(r),Math.abs(n));r&&(r/=Math.abs(r)),n&&(n/=Math.abs(n));for(let o=0;o<a;o++){e(t+o*r,i+o*n,0)}return!0}createPriorityWalls(e){if(!this._endsWithAWall)return;let t=this._startX,i=this._startY,r=this._endX-t,n=this._endY-i;r&&(r/=Math.abs(r)),n&&(n/=Math.abs(n));let a=n,o=-r;e(this._endX+r,this._endY+n),e(this._endX+a,this._endY+o),e(this._endX-a,this._endY-o)}}const z={room:F,corridor:j};function Y(e,t,i){i[t[e+1]]=i[e],t[i[e]]=t[e+1],i[e]=e+1,t[e+1]=e}function N(e,t,i){i[t[e]]=i[e],t[i[e]]=t[e],i[e]=e,t[e]=e}var X={Arena:class extends G{create(e){let t=this._width-1,i=this._height-1;for(let r=0;r<=t;r++)for(let n=0;n<=i;n++){e(r,n,r&&n&&r<t&&n<i?0:1)}return this}},Uniform:class extends H{constructor(e,t,i){super(e,t),this._options={roomWidth:[3,9],roomHeight:[3,5],roomDugPercentage:.1,timeLimit:1e3},Object.assign(this._options,i),this._map=[],this._dug=0,this._roomAttempts=20,this._corridorAttempts=20,this._connected=[],this._unconnected=[],this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this)}create(e){let t=Date.now();for(;;){if(Date.now()-t>this._options.timeLimit)return null;if(this._map=this._fillMap(1),this._dug=0,this._rooms=[],this._unconnected=[],this._generateRooms(),!(this._rooms.length<2)&&this._generateCorridors())break}if(e)for(let t=0;t<this._width;t++)for(let i=0;i<this._height;i++)e(t,i,this._map[t][i]);return this}_generateRooms(){let e,t=this._width-2,i=this._height-2;do{if(e=this._generateRoom(),this._dug/(t*i)>this._options.roomDugPercentage)break}while(e)}_generateRoom(){let e=0;for(;e<this._roomAttempts;){e++;let t=F.createRandom(this._width,this._height,this._options);if(t.isValid(this._isWallCallback,this._canBeDugCallback))return t.create(this._digCallback),this._rooms.push(t),t}return null}_generateCorridors(){let e=0;for(;e<this._corridorAttempts;){e++,this._corridors=[],this._map=this._fillMap(1);for(let e=0;e<this._rooms.length;e++){let t=this._rooms[e];t.clearDoors(),t.create(this._digCallback)}for(this._unconnected=n.a.shuffle(this._rooms.slice()),this._connected=[],this._unconnected.length&&this._connected.push(this._unconnected.pop());;){let e=n.a.getItem(this._connected);if(!e)break;let t=this._closestRoom(this._unconnected,e);if(!t)break;let i=this._closestRoom(this._connected,t);if(!i)break;if(!this._connectRooms(t,i))break;if(!this._unconnected.length)return!0}}return!1}_closestRoom(e,t){let i=1/0,r=t.getCenter(),n=null;for(let t=0;t<e.length;t++){let a=e[t],o=a.getCenter(),s=o[0]-r[0],l=o[1]-r[1],h=s*s+l*l;h<i&&(i=h,n=a)}return n}_connectRooms(e,t){let i,r,n,a,o,s,l,h=e.getCenter(),c=t.getCenter(),u=c[0]-h[0],d=c[1]-h[1];if(Math.abs(u)<Math.abs(d)?(n=d>0?2:0,a=(n+2)%4,o=t.getLeft(),s=t.getRight(),l=0):(n=u>0?1:3,a=(n+2)%4,o=t.getTop(),s=t.getBottom(),l=1),i=this._placeInWall(e,n),!i)return!1;if(i[l]>=o&&i[l]<=s){r=i.slice();let e=0;switch(a){case 0:e=t.getTop()-1;break;case 1:e=t.getRight()+1;break;case 2:e=t.getBottom()+1;break;case 3:e=t.getLeft()-1}r[(l+1)%2]=e,this._digLine([i,r])}else if(i[l]<o-1||i[l]>s+1){let e=i[l]-c[l],n=0;switch(a){case 0:case 1:n=e<0?3:1;break;case 2:case 3:n=e<0?1:3}if(a=(a+n)%4,r=this._placeInWall(t,a),!r)return!1;let o=[0,0];o[l]=i[l];let s=(l+1)%2;o[s]=r[s],this._digLine([i,o,r])}else{let e=(l+1)%2;if(r=this._placeInWall(t,a),!r)return!1;let n=Math.round((r[e]+i[e])/2),o=[0,0],s=[0,0];o[l]=i[l],o[e]=n,s[l]=r[l],s[e]=n,this._digLine([i,o,s,r])}return e.addDoor(i[0],i[1]),t.addDoor(r[0],r[1]),l=this._unconnected.indexOf(e),-1!=l&&(this._unconnected.splice(l,1),this._connected.push(e)),l=this._unconnected.indexOf(t),-1!=l&&(this._unconnected.splice(l,1),this._connected.push(t)),!0}_placeInWall(e,t){let i=[0,0],r=[0,0],a=0;switch(t){case 0:r=[1,0],i=[e.getLeft(),e.getTop()-1],a=e.getRight()-e.getLeft()+1;break;case 1:r=[0,1],i=[e.getRight()+1,e.getTop()],a=e.getBottom()-e.getTop()+1;break;case 2:r=[1,0],i=[e.getLeft(),e.getBottom()+1],a=e.getRight()-e.getLeft()+1;break;case 3:r=[0,1],i=[e.getLeft()-1,e.getTop()],a=e.getBottom()-e.getTop()+1}let o=[],s=-2;for(let e=0;e<a;e++){let t=i[0]+e*r[0],n=i[1]+e*r[1];o.push(null),1==this._map[t][n]?s!=e-1&&(o[e]=[t,n]):(s=e,e&&(o[e-1]=null))}for(let e=o.length-1;e>=0;e--)o[e]||o.splice(e,1);return o.length?n.a.getItem(o):null}_digLine(e){for(let t=1;t<e.length;t++){let i=e[t-1],r=e[t],n=new j(i[0],i[1],r[0],r[1]);n.create(this._digCallback),this._corridors.push(n)}}_digCallback(e,t,i){this._map[e][t]=i,0==i&&this._dug++}_isWallCallback(e,t){return!(e<0||t<0||e>=this._width||t>=this._height)&&1==this._map[e][t]}_canBeDugCallback(e,t){return!(e<1||t<1||e+1>=this._width||t+1>=this._height)&&1==this._map[e][t]}},Cellular:class extends G{constructor(e,t,i={}){super(e,t),this._options={born:[5,6,7,8],survive:[4,5,6,7,8],topology:8},this.setOptions(i),this._dirs=M[this._options.topology],this._map=this._fillMap(0)}randomize(e){for(let t=0;t<this._width;t++)for(let i=0;i<this._height;i++)this._map[t][i]=n.a.getUniform()<e?1:0;return this}setOptions(e){Object.assign(this._options,e)}set(e,t,i){this._map[e][t]=i}create(e){let t=this._fillMap(0),i=this._options.born,r=this._options.survive;for(let e=0;e<this._height;e++){let n=1,a=0;6==this._options.topology&&(n=2,a=e%2);for(let o=a;o<this._width;o+=n){let n=this._map[o][e],a=this._getNeighbors(o,e);n&&-1!=r.indexOf(a)?t[o][e]=1:n||-1==i.indexOf(a)||(t[o][e]=1)}}this._map=t,e&&this._serviceCallback(e)}_serviceCallback(e){for(let t=0;t<this._height;t++){let i=1,r=0;6==this._options.topology&&(i=2,r=t%2);for(let n=r;n<this._width;n+=i)e(n,t,this._map[n][t])}}_getNeighbors(e,t){let i=0;for(let r=0;r<this._dirs.length;r++){let n=this._dirs[r],a=e+n[0],o=t+n[1];a<0||a>=this._width||o<0||o>=this._height||(i+=1==this._map[a][o]?1:0)}return i}connect(e,t,i){t||(t=0);let r=[],a={},o=1,s=[0,0];6==this._options.topology&&(o=2,s=[0,1]);for(let e=0;e<this._height;e++)for(let i=s[e%2];i<this._width;i+=o)if(this._freeSpace(i,e,t)){let t=[i,e];a[this._pointKey(t)]=t,r.push([i,e])}let l=r[n.a.getUniformInt(0,r.length-1)],h=this._pointKey(l),c={};for(c[h]=l,delete a[h],this._findConnected(c,a,[l],!1,t);Object.keys(a).length>0;){let e=this._getFromTo(c,a),r=e[0],n=e[1],o={};o[this._pointKey(r)]=r,this._findConnected(o,a,[r],!0,t),(6==this._options.topology?this._tunnelToConnected6:this._tunnelToConnected).call(this,n,r,c,a,t,i);for(let e in o){let i=o[e];this._map[i[0]][i[1]]=t,c[e]=i,delete a[e]}}e&&this._serviceCallback(e)}_getFromTo(e,t){let i,r=[0,0],a=[0,0],o=Object.keys(e),s=Object.keys(t);for(let l=0;l<5;l++){if(o.length<s.length){let i=o;a=e[i[n.a.getUniformInt(0,i.length-1)]],r=this._getClosest(a,t)}else{let i=s;r=t[i[n.a.getUniformInt(0,i.length-1)]],a=this._getClosest(r,e)}if(i=(r[0]-a[0])*(r[0]-a[0])+(r[1]-a[1])*(r[1]-a[1]),i<64)break}return[r,a]}_getClosest(e,t){let i=null,r=null;for(let n in t){let a=t[n],o=(a[0]-e[0])*(a[0]-e[0])+(a[1]-e[1])*(a[1]-e[1]);(null==r||o<r)&&(r=o,i=a)}return i}_findConnected(e,t,i,r,n){for(;i.length>0;){let a,o=i.splice(0,1)[0];a=6==this._options.topology?[[o[0]+2,o[1]],[o[0]+1,o[1]-1],[o[0]-1,o[1]-1],[o[0]-2,o[1]],[o[0]-1,o[1]+1],[o[0]+1,o[1]+1]]:[[o[0]+1,o[1]],[o[0]-1,o[1]],[o[0],o[1]+1],[o[0],o[1]-1]];for(let o=0;o<a.length;o++){let s=this._pointKey(a[o]);null==e[s]&&this._freeSpace(a[o][0],a[o][1],n)&&(e[s]=a[o],r||delete t[s],i.push(a[o]))}}}_tunnelToConnected(e,t,i,r,n,a){let o,s;t[0]<e[0]?(o=t,s=e):(o=e,s=t);for(let e=o[0];e<=s[0];e++){this._map[e][o[1]]=n;let t=[e,o[1]],a=this._pointKey(t);i[a]=t,delete r[a]}a&&o[0]<s[0]&&a(o,[s[0],o[1]]);let l=s[0];t[1]<e[1]?(o=t,s=e):(o=e,s=t);for(let e=o[1];e<s[1];e++){this._map[l][e]=n;let t=[l,e],a=this._pointKey(t);i[a]=t,delete r[a]}a&&o[1]<s[1]&&a([s[0],o[1]],[s[0],s[1]])}_tunnelToConnected6(e,t,i,r,n,a){let o,s;t[0]<e[0]?(o=t,s=e):(o=e,s=t);let l=o[0],h=o[1];for(;l!=s[0]||h!=s[1];){let e=2;h<s[1]?(h++,e=1):h>s[1]&&(h--,e=1),l<s[0]?l+=e:l>s[0]?l-=e:s[1]%2?l-=e:l+=e,this._map[l][h]=n;let t=[l,h],a=this._pointKey(t);i[a]=t,delete r[a]}a&&a(t,e)}_freeSpace(e,t,i){return e>=0&&e<this._width&&t>=0&&t<this._height&&this._map[e][t]==i}_pointKey(e){return e[0]+"."+e[1]}},Digger:class extends H{constructor(e,t,i={}){super(e,t),this._options=Object.assign({roomWidth:[3,9],roomHeight:[3,5],corridorLength:[3,10],dugPercentage:.2,timeLimit:1e3},i),this._features={room:4,corridor:4},this._map=[],this._featureAttempts=20,this._walls={},this._dug=0,this._digCallback=this._digCallback.bind(this),this._canBeDugCallback=this._canBeDugCallback.bind(this),this._isWallCallback=this._isWallCallback.bind(this),this._priorityWallCallback=this._priorityWallCallback.bind(this)}create(e){this._rooms=[],this._corridors=[],this._map=this._fillMap(1),this._walls={},this._dug=0;let t=(this._width-2)*(this._height-2);this._firstRoom();let i,r=Date.now();do{if(i=0,Date.now()-r>this._options.timeLimit)break;let e=this._findWall();if(!e)break;let t=e.split(","),n=parseInt(t[0]),a=parseInt(t[1]),o=this._getDiggingDirection(n,a);if(!o)continue;let s=0;do{if(s++,this._tryFeature(n,a,o[0],o[1])){this._removeSurroundingWalls(n,a),this._removeSurroundingWalls(n-o[0],a-o[1]);break}}while(s<this._featureAttempts);for(let e in this._walls)this._walls[e]>1&&i++}while(this._dug/t<this._options.dugPercentage||i);if(this._addDoors(),e)for(let t=0;t<this._width;t++)for(let i=0;i<this._height;i++)e(t,i,this._map[t][i]);return this._walls={},this._map=[],this}_digCallback(e,t,i){0==i||2==i?(this._map[e][t]=0,this._dug++):this._walls[e+","+t]=1}_isWallCallback(e,t){return!(e<0||t<0||e>=this._width||t>=this._height)&&1==this._map[e][t]}_canBeDugCallback(e,t){return!(e<1||t<1||e+1>=this._width||t+1>=this._height)&&1==this._map[e][t]}_priorityWallCallback(e,t){this._walls[e+","+t]=2}_firstRoom(){let e=Math.floor(this._width/2),t=Math.floor(this._height/2),i=F.createRandomCenter(e,t,this._options);this._rooms.push(i),i.create(this._digCallback)}_findWall(){let e=[],t=[];for(let i in this._walls){2==this._walls[i]?t.push(i):e.push(i)}let i=t.length?t:e;if(!i.length)return null;let r=n.a.getItem(i.sort());return delete this._walls[r],r}_tryFeature(e,t,i,r){let a=n.a.getWeightedValue(this._features),o=z[a].createRandomAt(e,t,i,r,this._options);return!!o.isValid(this._isWallCallback,this._canBeDugCallback)&&(o.create(this._digCallback),o instanceof F&&this._rooms.push(o),o instanceof j&&(o.createPriorityWalls(this._priorityWallCallback),this._corridors.push(o)),!0)}_removeSurroundingWalls(e,t){let i=M[4];for(let r=0;r<i.length;r++){let n=i[r],a=e+n[0],o=t+n[1];delete this._walls[a+","+o],a=e+2*n[0],o=t+2*n[1],delete this._walls[a+","+o]}}_getDiggingDirection(e,t){if(e<=0||t<=0||e>=this._width-1||t>=this._height-1)return null;let i=null,r=M[4];for(let n=0;n<r.length;n++){let a=r[n],o=e+a[0],s=t+a[1];if(!this._map[o][s]){if(i)return null;i=a}}return i?[-i[0],-i[1]]:null}_addDoors(){let e=this._map;function t(t,i){return 1==e[t][i]}for(let e=0;e<this._rooms.length;e++){let i=this._rooms[e];i.clearDoors(),i.addDoors(t)}}},EllerMaze:class extends G{create(e){let t,i=this._fillMap(1),r=Math.ceil((this._width-2)/2),a=[],o=[];for(let e=0;e<r;e++)a.push(e),o.push(e);for(a.push(r-1),t=1;t+3<this._height;t+=2)for(let e=0;e<r;e++){let r=2*e+1,s=t;i[r][s]=0,e!=a[e+1]&&n.a.getUniform()>.375&&(Y(e,a,o),i[r+1][s]=0),e!=a[e]&&n.a.getUniform()>.375?N(e,a,o):i[r][s+1]=0}for(let e=0;e<r;e++){let r=2*e+1,s=t;i[r][s]=0,e!=a[e+1]&&(e==a[e]||n.a.getUniform()>.375)&&(Y(e,a,o),i[r+1][s]=0),N(e,a,o)}for(let t=0;t<this._width;t++)for(let r=0;r<this._height;r++)e(t,r,i[t][r]);return this}},DividedMaze:class extends G{constructor(){super(...arguments),this._stack=[],this._map=[]}create(e){let t=this._width,i=this._height;this._map=[];for(let e=0;e<t;e++){this._map.push([]);for(let r=0;r<i;r++){let n=0==e||0==r||e+1==t||r+1==i;this._map[e].push(n?1:0)}}this._stack=[[1,1,t-2,i-2]],this._process();for(let r=0;r<t;r++)for(let t=0;t<i;t++)e(r,t,this._map[r][t]);return this._map=[],this}_process(){for(;this._stack.length;){let e=this._stack.shift();this._partitionRoom(e)}}_partitionRoom(e){let t=[],i=[];for(let i=e[0]+1;i<e[2];i++){let r=this._map[i][e[1]-1],n=this._map[i][e[3]+1];!r||!n||i%2||t.push(i)}for(let t=e[1]+1;t<e[3];t++){let r=this._map[e[0]-1][t],n=this._map[e[2]+1][t];!r||!n||t%2||i.push(t)}if(!t.length||!i.length)return;let r=n.a.getItem(t),a=n.a.getItem(i);this._map[r][a]=1;let o=[],s=[];o.push(s);for(let t=e[0];t<r;t++)this._map[t][a]=1,s.push([t,a]);s=[],o.push(s);for(let t=r+1;t<=e[2];t++)this._map[t][a]=1,s.push([t,a]);s=[],o.push(s);for(let t=e[1];t<a;t++)this._map[r][t]=1,s.push([r,t]);s=[],o.push(s);for(let t=a+1;t<=e[3];t++)this._map[r][t]=1,s.push([r,t]);let l=n.a.getItem(o);for(let e=0;e<o.length;e++){let t=o[e];if(t==l)continue;let i=n.a.getItem(t);this._map[i[0]][i[1]]=0}this._stack.push([e[0],e[1],r-1,a-1]),this._stack.push([r+1,e[1],e[2],a-1]),this._stack.push([e[0],a+1,r-1,e[3]]),this._stack.push([r+1,a+1,e[2],e[3]])}},IceyMaze:class extends G{constructor(e,t,i=0){super(e,t),this._regularity=i,this._map=[]}create(e){let t=this._width,i=this._height,r=this._fillMap(1);t-=t%2?1:2,i-=i%2?1:2;let a=0,o=0,s=0,l=0,h=0,c=!1,u=[[0,0],[0,0],[0,0],[0,0]];do{if(a=1+2*Math.floor(n.a.getUniform()*(t-1)/2),o=1+2*Math.floor(n.a.getUniform()*(i-1)/2),h||(r[a][o]=0),!r[a][o]){this._randomize(u);do{0==Math.floor(n.a.getUniform()*(this._regularity+1))&&this._randomize(u),c=!0;for(let e=0;e<4;e++)if(s=a+2*u[e][0],l=o+2*u[e][1],this._isFree(r,s,l,t,i)){r[s][l]=0,r[a+u[e][0]][o+u[e][1]]=0,a=s,o=l,c=!1,h++;break}}while(!c)}}while(h+1<t*i/4);for(let t=0;t<this._width;t++)for(let i=0;i<this._height;i++)e(t,i,r[t][i]);return this._map=[],this}_randomize(e){for(let t=0;t<4;t++)e[t][0]=0,e[t][1]=0;switch(Math.floor(4*n.a.getUniform())){case 0:e[0][0]=-1,e[1][0]=1,e[2][1]=-1,e[3][1]=1;break;case 1:e[3][0]=-1,e[2][0]=1,e[1][1]=-1,e[0][1]=1;break;case 2:e[2][0]=-1,e[3][0]=1,e[0][1]=-1,e[1][1]=1;break;case 3:e[1][0]=-1,e[0][0]=1,e[3][1]=-1,e[2][1]=1}}_isFree(e,t,i,r,n){return!(t<1||i<1||t>=r||i>=n)&&e[t][i]}},Rogue:class extends G{constructor(e,t,i){super(e,t),this.map=[],this.rooms=[],this.connectedCells=[],(i=Object.assign({cellWidth:3,cellHeight:3},i)).hasOwnProperty("roomWidth")||(i.roomWidth=this._calculateRoomSize(this._width,i.cellWidth)),i.hasOwnProperty("roomHeight")||(i.roomHeight=this._calculateRoomSize(this._height,i.cellHeight)),this._options=i}create(e){if(this.map=this._fillMap(1),this.rooms=[],this.connectedCells=[],this._initRooms(),this._connectRooms(),this._connectUnconnectedRooms(),this._createRandomRoomConnections(),this._createRooms(),this._createCorridors(),e)for(let t=0;t<this._width;t++)for(let i=0;i<this._height;i++)e(t,i,this.map[t][i]);return this}_calculateRoomSize(e,t){let i=Math.floor(e/t*.8),r=Math.floor(e/t*.25);return r<2&&(r=2),i<2&&(i=2),[r,i]}_initRooms(){for(let e=0;e<this._options.cellWidth;e++){this.rooms.push([]);for(let t=0;t<this._options.cellHeight;t++)this.rooms[e].push({x:0,y:0,width:0,height:0,connections:[],cellx:e,celly:t})}}_connectRooms(){let e,t,i,r,a,o,s=n.a.getUniformInt(0,this._options.cellWidth-1),l=n.a.getUniformInt(0,this._options.cellHeight-1),h=!1;do{o=[0,2,4,6],o=n.a.shuffle(o);do{if(h=!1,e=o.pop(),t=s+M[8][e][0],i=l+M[8][e][1],!(t<0||t>=this._options.cellWidth||i<0||i>=this._options.cellHeight)){if(r=this.rooms[s][l],r.connections.length>0&&r.connections[0][0]==t&&r.connections[0][1]==i)break;a=this.rooms[t][i],0==a.connections.length&&(a.connections.push([s,l]),this.connectedCells.push([t,i]),s=t,l=i,h=!0)}}while(o.length>0&&0==h)}while(o.length>0)}_connectUnconnectedRooms(){let e,t,i,r=this._options.cellWidth,a=this._options.cellHeight;this.connectedCells=n.a.shuffle(this.connectedCells);for(let o=0;o<this._options.cellWidth;o++)for(let s=0;s<this._options.cellHeight;s++)if(e=this.rooms[o][s],0==e.connections.length){let l=[0,2,4,6];l=n.a.shuffle(l),i=!1;do{let e=l.pop(),n=o+M[8][e][0],h=s+M[8][e][1];if(!(n<0||n>=r||h<0||h>=a)){if(t=this.rooms[n][h],i=!0,0==t.connections.length)break;for(let e=0;e<t.connections.length;e++)if(t.connections[e][0]==o&&t.connections[e][1]==s){i=!1;break}if(i)break}}while(l.length);i?e.connections.push([t.cellx,t.celly]):console.log("-- Unable to connect room.")}}_createRandomRoomConnections(){}_createRooms(){let e,t,i,r,a,o=this._width,s=this._height,l=this._options.cellWidth,h=this._options.cellHeight,c=Math.floor(this._width/l),u=Math.floor(this._height/h),d=this._options.roomWidth,f=this._options.roomHeight;for(let p=0;p<l;p++)for(let l=0;l<h;l++){if(i=c*p,r=u*l,0==i&&(i=1),0==r&&(r=1),e=n.a.getUniformInt(d[0],d[1]),t=n.a.getUniformInt(f[0],f[1]),l>0)for(a=this.rooms[p][l-1];r-(a.y+a.height)<3;)r++;if(p>0)for(a=this.rooms[p-1][l];i-(a.x+a.width)<3;)i++;let h=Math.round(n.a.getUniformInt(0,c-e)/2),g=Math.round(n.a.getUniformInt(0,u-t)/2);for(;i+h+e>=o;)h?h--:e--;for(;r+g+t>=s;)g?g--:t--;i+=h,r+=g,this.rooms[p][l].x=i,this.rooms[p][l].y=r,this.rooms[p][l].width=e,this.rooms[p][l].height=t;for(let n=i;n<i+e;n++)for(let e=r;e<r+t;e++)this.map[n][e]=0}}_getWallPosition(e,t){let i,r,a;return 1==t||3==t?(i=n.a.getUniformInt(e.x+1,e.x+e.width-2),1==t?(r=e.y-2,a=r+1):(r=e.y+e.height+1,a=r-1),this.map[i][a]=0):(r=n.a.getUniformInt(e.y+1,e.y+e.height-2),2==t?(i=e.x+e.width+1,a=i-1):(i=e.x-2,a=i+1),this.map[a][r]=0),[i,r]}_drawCorridor(e,t){let i,r,a,o,s=t[0]-e[0],l=t[1]-e[1],h=e[0],c=e[1],u=[],d=Math.abs(s),f=Math.abs(l),p=n.a.getUniform(),g=p,m=1-p;for(r=s>0?2:6,a=l>0?4:0,d<f?(i=Math.ceil(f*g),u.push([a,i]),u.push([r,d]),i=Math.floor(f*m),u.push([a,i])):(i=Math.ceil(d*g),u.push([r,i]),u.push([a,f]),i=Math.floor(d*m),u.push([r,i])),this.map[h][c]=0;u.length>0;)for(o=u.pop();o[1]>0;)h+=M[8][o[0]][0],c+=M[8][o[0]][1],this.map[h][c]=0,o[1]=o[1]-1}_createCorridors(){let e,t,i,r,n,a=this._options.cellWidth,o=this._options.cellHeight;for(let s=0;s<a;s++)for(let a=0;a<o;a++){e=this.rooms[s][a];for(let a=0;a<e.connections.length;a++)t=e.connections[a],i=this.rooms[t[0]][t[1]],i.cellx>e.cellx?(r=2,n=4):i.cellx<e.cellx?(r=4,n=2):i.celly>e.celly?(r=3,n=1):(r=1,n=3),this._drawCorridor(this._getWallPosition(e,r),this._getWallPosition(i,n))}}}};Math.sqrt(3),Math.sqrt(3);class q{constructor(e,t,i,r={}){this._toX=e,this._toY=t,this._passableCallback=i,this._options=Object.assign({topology:8},r),this._dirs=M[this._options.topology],8==this._options.topology&&(this._dirs=[this._dirs[0],this._dirs[2],this._dirs[4],this._dirs[6],this._dirs[1],this._dirs[3],this._dirs[5],this._dirs[7]])}_getNeighbors(e,t){let i=[];for(let r=0;r<this._dirs.length;r++){let n=this._dirs[r],a=e+n[0],o=t+n[1];this._passableCallback(a,o)&&i.push([a,o])}return i}}var U={Dijkstra:class extends q{constructor(e,t,i,r){super(e,t,i,r),this._computed={},this._todo=[],this._add(e,t,null)}compute(e,t,i){let r=e+","+t;if(r in this._computed||this._compute(e,t),!(r in this._computed))return;let n=this._computed[r];for(;n;)i(n.x,n.y),n=n.prev}_compute(e,t){for(;this._todo.length;){let i=this._todo.shift();if(i.x==e&&i.y==t)return;let r=this._getNeighbors(i.x,i.y);for(let e=0;e<r.length;e++){let t=r[e],n=t[0],a=t[1];n+","+a in this._computed||this._add(n,a,i)}}}_add(e,t,i){let r={x:e,y:t,prev:i};this._computed[e+","+t]=r,this._todo.push(r)}},AStar:class extends q{constructor(e,t,i,r={}){super(e,t,i,r),this._todo=[],this._done={}}compute(e,t,i){for(this._todo=[],this._done={},this._fromX=e,this._fromY=t,this._add(this._toX,this._toY,null);this._todo.length;){let i=this._todo.shift(),r=i.x+","+i.y;if(r in this._done)continue;if(this._done[r]=i,i.x==e&&i.y==t)break;let n=this._getNeighbors(i.x,i.y);for(let e=0;e<n.length;e++){let t=n[e],r=t[0],a=t[1];r+","+a in this._done||this._add(r,a,i)}}let r=this._done[e+","+t];if(r)for(;r;)i(r.x,r.y),r=r.prev}_add(e,t,i){let r=this._distance(e,t),n={x:e,y:t,prev:i,g:i?i.g+1:0,h:r},a=n.g+n.h;for(let e=0;e<this._todo.length;e++){let t=this._todo[e],i=t.g+t.h;if(a<i||a==i&&r<t.h)return void this._todo.splice(e,0,n)}this._todo.push(n)}_distance(e,t){switch(this._options.topology){case 4:return Math.abs(e-this._fromX)+Math.abs(t-this._fromY);case 6:let i=Math.abs(e-this._fromX),r=Math.abs(t-this._fromY);return r+Math.max(0,(i-r)/2);case 8:return Math.max(Math.abs(e-this._fromX),Math.abs(t-this._fromY))}}}};var K=["Alichino","Barbariccia","Cagnazzo","Calcabrina","Ciriatto","Draghignazzo","Farfarello","Graffiacane","Libicocco","Malacoda,","Rubicante","Scarmiglione"],V=["Poppy","Branch","Bridget","King Gristle","Chef","Creek","DJ Suki","King Gristle Sr","Biggie","King Peppy","Cooper","Satin","Chenille","Guy Diamond","Harper"],J=["Ancalagon the Black","Chrysophylax Dives","Dagurashibanipal","Drogon","Errol","Faranth","Fírnen","Glaedr","Glaurung","Icefyre","Igjarjuk","Katla","Montague Bunsen-Burner","Mnementh","Moon","Norberta","Pyralspite","Ramoth","Rhaegal","Ruth","Saphira","Slathborg","Smaug","Temeraire","Terezi's Lusus","Thorn","Tintaglia","Eldrax","Viserion"],$=["Sir Lancelot","Sir Gawain","Sir Geraint","Sir Percival","Sir Bors the Younger","Sir Lamorak","Sir Kay","Sir Gareth","Sir Bedivere","Sir Gaheris","Sir Galahad","Sir Tristan","Sir Palamedes","Sir Aban","Sir Abrioris","Sir Adragain","Sir Aglovale","Sir Agravain","Sir Aqiff","King Bagdemagus","Sir Baudwin","Sir Brastius","Sir Bredbeddle","Sir Breunor","Sir Caradoc","Sir Calogrenant","Sir Constantine","Sir Dagonet, the court jester","Sir Degore","Sir Daniel","Sir Dinadan","Sir Dornar","Sir Ector","Sir Ector de Maris","Sir Elyan the White","Sir Galehaut","Sir Galeshin","Sir Gingalain","Sir Griflet","King Leodegrance","Sir Lionel","Sir Lucan","Sir Mador de la Porte","Sir Maleagant","Sir Mordred","Sir Morien","Sir Pelleas","King Pellinore","Sir Pinel","Sir Sagramore le Desirous","Sir Safir","Sir Segwarides","Sir Tor","Sir Ulfius","King Uriens","Sir Yvain","Sir Ywain the Bastard"];function Z(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Q(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(i),!0).forEach((function(t){ee(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Z(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function ee(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var te="#ff0",ie="#0f0",re="#f00",ne="#fefefe",ae="#FF7034",oe="#777",se={38:0,75:0,87:0,39:1,76:1,68:1,40:2,74:2,83:2,37:3,72:3,65:3},le=Q({},se,{71:"Gear",73:"Gear",27:"Menu",77:"Menu"}),he=Q({},se,{27:"Cancel",77:"Cancel",13:"Select",32:"Select"}),ce=25,ue=80,de={WALL:"█",POTION:"ɋ",WEAPON:"Ψ",ARMOR:"Θ",AMULET:"ϙ",OPEN:".",PLAYER:"@",ENEMY:"D",MODAL_CORNER_TOP_LEFT:"◸",MODAL_CORNER_TOP_RIGHT:"◹",MODAL_CORNER_BOTTOM_LEFT:"◺",MODAL_CORNER_BOTTOM_RIGHT:"◿",MODAL_Y:"|",MODAL_X:"-",LADDER:"▤",BULLET:"▶"},fe={89:!0,78:!1},pe={Armor:5,Weapon:5,Amulet:1},ge={GOBLIN:{type:"Goblin",stats:{strength:1,dexterity:1,maxHp:3},xp:1,dropPercentage:10,color:re},SKELETON:{type:"Skeleton",stats:{strength:2,dexterity:5,maxHp:4},xp:3,dropPercentage:5,color:re},TROLL:{type:"Troll",stats:{strength:5,dexterity:0,maxHp:25},xp:10,dropPercentage:30,color:re},DRAGON:{type:"Dragon",stats:{strength:17,dexterity:10,maxHp:40},xp:30,dropPercentage:80,color:re},BALROG:{type:"Balrog",stats:{strength:25,dexterity:40,maxHp:80},xp:0,dropPercentage:0,color:ae}},me={1:2,2:6,3:15,4:45,5:70,6:100,7:155,8:200,9:283,10:334,11:444,12:576,13:733,14:915,15:1125,16:1366,17:4913,18:5832,19:6859};function _e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var be=function(){function e(t,i,r,n,a,o,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.display=t,this.callback=i,this.width=n,this.height=this.addText(r)+2,this.positionX=a,this.positionY=o,this.addOutline(),this.clear(),this.addText(r),this.modalChoices=s,window.addEventListener("keydown",this)}var t,i,r;return t=e,(i=[{key:"handleEvent",value:function(e){var t=e.keyCode;if(!this.modalChoices||t in this.modalChoices){var i=this.modalChoices||{};window.removeEventListener("keydown",this),this.callback(i[t])}}},{key:"addOutline",value:function(){for(var e=this.positionX+1;e<this.positionX+this.width;e++)this.display.draw(e,this.positionY,de.MODAL_X),this.display.draw(e,this.positionY+this.height,de.MODAL_X);for(var t=this.positionY+1;t<this.positionY+this.height;t++)this.display.draw(this.positionX,t,de.MODAL_Y),this.display.draw(this.positionX+this.width,t,de.MODAL_Y);this.display.draw(this.positionX,this.positionY,de.MODAL_CORNER_TOP_LEFT),this.display.draw(this.positionX,this.positionY+this.height,de.MODAL_CORNER_BOTTOM_LEFT),this.display.draw(this.positionX+this.width,this.positionY,de.MODAL_CORNER_TOP_RIGHT),this.display.draw(this.positionX+this.width,this.positionY+this.height,de.MODAL_CORNER_BOTTOM_RIGHT)}},{key:"addText",value:function(e){return this.display.drawText(this.positionX+1,this.positionY+1,e,this.width-2)}},{key:"clear",value:function(){for(var e=this.positionX+1;e<this.positionX+this.width;e++)for(var t=this.positionY+1;t<this.positionY+this.height;t++)this.display.draw(e,t," ")}}])&&_e(t.prototype,i),r&&_e(t,r),e}();function ye(e,t){new be(e,t,"\n  Wander the depths of the dungeon collecting items and defeating foes to grant you experience until you find and are able to defeat the dark master of the pit...\n\n  Movement: ▲ ▼ ◄ ► / WSAD / KJHL\n  Inventory: I/G\n  Help: M/Esc\n  ",40,20,5)}var ve=i(6),we=i.n(ve),ke="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),Se=new Uint8Array(16);function xe(){if(!ke)throw new Error("uuid: This browser does not seem to support crypto.getRandomValues(). If you need to support this browser, please provide a custom random number generator through options.rng.");return ke(Se)}for(var Ce=[],Ae=0;Ae<256;++Ae)Ce[Ae]=(Ae+256).toString(16).substr(1);var Me=function(e,t){var i=t||0,r=Ce;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")};var Oe=function(e,t,i){var r=t&&i||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var n=(e=e||{}).random||(e.rng||xe)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t)for(var a=0;a<16;++a)t[r+a]=n[a];return t||Me(n)},Te=["Aardwolf","Admiral","Adouri","African black crake","African buffalo","African bush squirrel","African clawless otter","African darter","African elephant","African fish eagle","African ground squirrel","African jacana","African lion","African lynx","African pied wagtail","African polecat","African porcupine","African red-eyed bulbul","African skink","African snake","African wild cat","African wild dog","Agama lizard","Agile wallaby","Agouti","Albatross","Albatross","Alligator","Alligator","Alpaca","Amazon parrot","American Virginia opossum","American alligator","American badger","American beaver","American bighorn sheep","American bison","American black bear","American buffalo","American crow","American marten","American racer","American woodcock","Anaconda","Andean goose","Ant","Anteater","Anteater","Antechinus","Antelope ground squirrel","Antelope","Antelope","Antelope","Arboral spiny rat","Arctic fox","Arctic ground squirrel","Arctic hare","Arctic lemming","Arctic tern","Argalis","Armadillo","Armadillo","Armadillo","Armadillo","Asian elephant","Asian false vampire bat","Asian foreset tortoise","Asian lion","Asian openbill","Asian red fox","Asian water buffalo","Asian water dragon","Asiatic jackal","Asiatic wild ass","Ass","Australian brush turkey","Australian magpie","Australian masked owl","Australian pelican","Australian sea lion","Australian spiny anteater","Avocet","Azara's zorro","Baboon","Baboon","Baboon","Baboon","Baboon","Badger","Badger","Badger","Badger","Bahama pintail","Bald eagle","Baleen whale","Banded mongoose","Bandicoot","Bandicoot","Bandicoot","Barasingha deer","Barbet","Barbet","Barbet","Bare-faced go away bird","Barking gecko","Barrows goldeneye","Bat","Bat","Bat","Bat-eared fox","Bateleur eagle","Bear","Bear","Bear","Bear","Bear","Beaver","Beaver","Beaver","Beaver","Bee-eater","Bee-eater","Bee-eater","Bee-eater","Beisa oryx","Bengal vulture","Bennett's wallaby","Bent-toed gecko","Bettong","Bird","Bird","Bird","Bird","Bird","Bird","Bird","Bison","Black and white colobus","Black bear","Black curlew","Black kite","Black rhinoceros","Black spider monkey","Black swan","Black vulture","Black-backed jackal","Black-backed magpie","Black-capped capuchin","Black-capped chickadee","Black-cheeked waxbill","Black-collared barbet","Black-crowned crane","Black-crowned night heron","Black-eyed bulbul","Black-faced kangaroo","Black-footed ferret","Black-fronted bulbul","Black-necked stork","Black-tailed deer","Black-tailed prairie dog","Black-tailed tree creeper","Black-throated butcher bird","Black-throated cardinal","Black-winged stilt","Blackbird","Blackbuck","Blackish oystercatcher","Blacksmith plover","Bleeding heart monkey","Blesbok","Bleu","Bleu","Blue and gold macaw","Blue and yellow macaw","Blue catfish","Blue crane","Blue duck","Blue fox","Blue peacock","Blue racer","Blue shark","Blue waxbill","Blue wildebeest","Blue-breasted cordon bleu","Blue-faced booby","Blue-footed booby","Blue-tongued lizard","Blue-tongued skink","Boa","Boa","Boa","Boa","Boa","Boar","Boat-billed heron","Bobcat","Bohor reedbuck","Bonnet macaque","Bontebok","Booby","Booby","Booby","Bottle-nose dolphin","Boubou","Brazilian otter","Brazilian tapir","Brindled gnu","Brocket","Brocket","Brolga crane","Brown and yellow marshbird","Brown antechinus","Brown brocket","Brown capuchin","Brown hyena","Brown lemur","Brown pelican","Brush-tailed bettong","Brush-tailed phascogale","Brush-tailed rat kangaroo","Buffalo","Buffalo","Buffalo","Buffalo","Bulbul","Bulbul","Bulbul","Bunting","Burchell's gonolek","Burmese black mountain tortoise","Burmese brown mountain tortoise","Burrowing owl","Bush dog","Bushbaby","Bushbuck","Bushpig","Bustard","Bustard","Bustard","Butterfly","Butterfly","Butterfly","Buttermilk snake","Caiman","California sea lion","Camel","Campo flicker","Canada goose","Canadian river otter","Cape Barren goose","Cape clawless otter","Cape cobra","Cape fox","Cape raven","Cape starling","Cape white-eye","Cape wild cat","Capuchin","Capuchin","Capuchin","Capuchin","Capybara","Caracal","Caracara","Caracara","Cardinal","Cardinal","Caribou","Carmine bee-eater","Carpet python","Carpet snake","Cat","Cat","Cat","Cat","Cat","Cat","Cat","Cat","Cat","Cat","Cat","Cat","Catfish","Cattle egret","Cereopsis goose","Chacma baboon","Chameleon","Cheetah","Chestnut weaver","Chickadee","Chilean flamingo","Chimpanzee","Chipmunk","Chital","Chuckwalla","Civet","Civet cat","Civet","Civet","Clark's nutcracker","Cliffchat","Coatimundi","Coatimundi","Cobra","Cobra","Cobra","Cockatoo","Cockatoo","Cockatoo","Cockatoo","Cockatoo","Cockatoo","Coke's hartebeest","Collared lemming","Collared lizard","Collared peccary","Colobus","Colobus","Colobus","Columbian rainbow boa","Comb duck","Common boubou shrike","Common brushtail possum","Common dolphin","Common duiker","Common eland","Common genet","Common goldeneye","Common green iguana","Common grenadier","Common langur","Common long-nosed armadillo","Common melba finch","Common mynah","Common nighthawk","Common palm civet","Common pheasant","Common raccoon","Common rhea","Common ringtail","Common seal","Common shelduck","Common turkey","Common wallaroo","Common waterbuck","Common wolf","Common wombat","Common zebra","Common zorro","Constrictor","Cook's tree boa","Coot","Coqui francolin","Coqui partridge","Corella","Cormorant","Cormorant","Cormorant","Cormorant","Cormorant","Cormorant","Cormorant","Cormorant","Cormorant","Cottonmouth","Cougar","Cow","Coyote","Crab","Crab","Crab","Crab-eating fox","Crab-eating raccoon","Crake","Crane","Crane","Crane","Crane","Crane","Crane","Crane","Creeper","Crested barbet","Crested bunting","Crested porcupine","Crested screamer","Crimson-breasted shrike","Crocodile","Crow","Crow","Crow","Crown of thorns starfish","Crowned eagle","Crowned hawk-eagle","Cuis","Curlew","Currasow","Curve-billed thrasher","Dabchick","Dama wallaby","Dark-winged trumpeter","Darter","Darwin ground finch","Dassie","Deer","Deer","Deer","Deer","Deer","Deer","Deer","Deer","Deer","Defassa waterbuck","Denham's bustard","Desert kangaroo rat","Desert spiny lizard","Desert tortoise","Devil","Dik","Dingo","Dog","Dog","Dog","Dog","Dolphin","Dolphin","Dolphin","Dove","Dove","Dove","Dove","Dove","Dove","Dove","Dove","Downy woodpecker","Dragon","Dragon","Dragon","Dragon","Dragon","Dragon","Dragonfly","Dromedary camel","Drongo","Duck","Duck","Duck","Duck","Duiker","Duiker","Dunnart","Dusky gull","Dusky rattlesnake","Eagle owl","Eagle","Eagle","Eagle","Eagle","Eagle","Eagle","Eagle","Eagle","Eagle","Eastern boa constrictor","Eastern box turtle","Eastern cottontail rabbit","Eastern diamondback rattlesnake","Eastern dwarf mongoose","Eastern fox squirrel","Eastern grey kangaroo","Eastern indigo snake","Eastern quoll","Eastern white pelican","Echidna","Egret","Egret","Egret","Egyptian cobra","Egyptian goose","Egyptian viper","Egyptian vulture","Eland","Elegant crested tinamou","Elephant","Elephant","Eleven-banded armadillo","Elk","Emerald green tree boa","Emerald-spotted wood dove","Emu","Eurasian badger","Eurasian beaver","Eurasian hoopoe","Eurasian red squirrel","Euro wallaby","European badger","European beaver","European red squirrel","European shelduck","European spoonbill","European stork","European wild cat","Fairy penguin","Falcon","Falcon","Fat-tailed dunnart","Feathertail glider","Feral rock pigeon","Ferret","Ferruginous hawk","Field flicker","Finch","Fisher","Flamingo","Flamingo","Flamingo","Flamingo","Flicker","Flicker","Flightless cormorant","Flycatcher","Flying fox","Fork-tailed drongo","Four-horned antelope","Four-spotted skimmer","Four-striped grass mouse","Fowl","Fox","Fox","Fox","Fox","Fox","Fox","Fox","Fox","Fox","Fox","Fox","Francolin","Francolin","Frilled dragon","Frilled lizard","Fringe-eared oryx","Frog","Frogmouth","Galah","Galapagos albatross","Galapagos dove","Galapagos hawk","Galapagos mockingbird","Galapagos penguin","Galapagos sea lion","Galapagos tortoise","Gambel's quail","Gaur","Gazelle","Gazelle","Gazer","Gecko","Gecko","Gecko","Gecko","Gecko","Gelada baboon","Gemsbok","Genet","Genet","Genoveva","Gerbil","Gerenuk","Giant anteater","Giant armadillo","Giant girdled lizard","Giant heron","Giant otter","Gila monster","Giraffe","Glider","Glider","Glider","Glossy ibis","Glossy starling","Gnu","Goanna lizard","Goat","Godwit","Golden brush-tailed possum","Golden eagle","Golden jackal","Golden-mantled ground squirrel","Goldeneye","Goldeneye","Goliath heron","Gonolek","Goose","Goose","Goose","Goose","Goose","Goose","Goose","Goose","Goose","Gorilla","Grant's gazelle","Gray duiker","Gray heron","Gray langur","Gray rhea","Great cormorant","Great egret","Great horned owl","Great kiskadee","Great skua","Great white pelican","Greater adjutant stork","Greater blue-eared starling","Greater flamingo","Greater kudu","Greater rhea","Greater roadrunner","Greater sage grouse","Grebe","Green heron","Green vine snake","Green-backed heron","Green-winged macaw","Green-winged trumpeter","Grenadier","Grenadier","Grey fox","Grey heron","Grey lourie","Grey mouse lemur","Grey phalarope","Grey-footed squirrel","Greylag goose","Griffon vulture","Grison","Grizzly bear","Ground legaan","Ground monitor","Groundhog","Grouse","Grouse","Guanaco","Guerza","Gull","Gull","Gull","Gull","Gull","Gull","Gull","Gull","Gulls","Hanuman langur","Harbor seal","Hare","Hartebeest","Hartebeest","Hawk","Hawk","Hawk","Hawk-eagle","Hawk-headed parrot","Hedgehog","Helmeted guinea fowl","Hen","Heron","Heron","Heron","Heron","Heron","Heron","Heron","Heron","Heron","Heron","Heron","Herring gull","Hippopotamus","Hoary marmot","Hoffman's sloth","Honey badger","Hoopoe","Hornbill","Hornbill","Hornbill","Hornbill","Horned lark","Horned puffin","Horned rattlesnake","Hottentot teal","House crow","House sparrow","Hudsonian godwit","Hummingbird","Huron","Hyena","Hyena","Hyena","Hyrax","Ibex","Ibis","Ibis","Ibis","Iguana","Iguana","Iguana","Impala","Indian giant squirrel","Indian jackal","Indian leopard","Indian mynah","Indian peacock","Indian porcupine","Indian red admiral","Indian star tortoise","Indian tree pie","Insect","Jabiru stork","Jacana","Jackal","Jackal","Jackal","Jackal","Jackal","Jackrabbit","Jaeger","Jaguar","Jaguarundi","Japanese macaque","Javan gold-spotted mongoose","Javanese cormorant","Jungle cat","Jungle kangaroo","Kaffir cat","Kafue flats lechwe","Kalahari scrub robin","Kangaroo","Kangaroo","Kangaroo","Kangaroo","Kangaroo","Kangaroo","Kelp gull","Killer whale","King cormorant","King vulture","Kingfisher","Kingfisher","Kingfisher","Kinkajou","Kirk's dik dik","Kiskadee","Kite","Klipspringer","Knob-nosed goose","Koala","Komodo dragon","Kongoni","Kookaburra","Kori bustard","Kudu","Land iguana","Langur","Langur","Langur","Lappet-faced vulture","Lapwing","Lapwing","Large cormorant","Large-eared bushbaby","Lark","Laughing dove","Laughing kookaburra","Lava gull","Leadbeateri's ground hornbill","Least chipmunk","Lechwe","Legaan","Legaan","Legaan","Lemming","Lemming","Lemur","Lemur","Lemur","Lemur","Lemur","Leopard","Leopard","Lesser double-collared sunbird","Lesser flamingo","Lesser masked weaver","Lesser mouse lemur","Levaillant's barbet","Lilac-breasted roller","Lily trotter","Lion","Lion","Lion","Lion","Lion","Lion","Lion","Lion","Lion","Lion","Little blue penguin","Little brown bat","Little brown dove","Little cormorant","Little grebe","Little heron","Lizard","Lizard","Lizard","Lizard","Lizard","Lizard","Lizard","Lizard","Llama","Long-billed cockatoo","Long-billed corella","Long-crested hawk eagle","Long-finned pilot whale","Long-necked turtle","Long-nosed bandicoot","Long-tailed jaeger","Long-tailed skua","Long-tailed spotted cat","Lorikeet","Loris","Lory","Lourie","Lynx","Macaque","Macaque","Macaque","Macaque","Macaw","Macaw","Macaw","Macaw","Macaw","Madagascar fruit bat","Madagascar hawk owl","Magellanic penguin","Magistrate black colobus","Magnificent frigate bird","Magpie","Magpie","Malabar squirrel","Malachite kingfisher","Malagasy ground boa","Malay squirrel","Mallard","Malleefowl","Manatee","Mandras tree shrew","Mara","Marabou stork","Margay","Marine iguana","Marmot","Marmot","Marshbird","Marten","Masked booby","Meerkat","Meerkat","Mexican beaded lizard","Mexican boa","Mexican wolf","Miner's cat","Mississippi alligator","Moccasin","Mocking cliffchat","Mockingbird","Mongoose","Mongoose","Mongoose","Mongoose","Mongoose","Monitor lizard","Monitor","Monitor","Monitor","Monkey","Monkey","Monkey","Monkey","Monkey","Monster","Moorhen","Moose","Mouflon","Mountain duck","Mountain goat","Mountain lion","Mourning collared dove","Mouse","Mudskipper","Mule deer","Musk ox","Mynah","Mynah","Native cat","Nelson ground squirrel","Neotropic cormorant","Netted rock dragon","Nighthawk","Nile crocodile","Nilgai","Nine-banded armadillo","North American beaver","North American porcupine","North American red fox","North American river otter","Northern elephant seal","Northern fur seal","Northern phalarope","Nubian bee-eater","Numbat","Nutcracker","Nuthatch","Nyala","Ocelot","Old world fruit bat","Olive baboon","Onager","Openbill stork","Openbill","Opossum","Orca","Oribi","Oriental short-clawed otter","Oriental white-backed vulture","Ornate rock dragon","Oryx","Oryx","Osprey","Ostrich","Otter","Otter","Otter","Otter","Otter","Otter","Otter","Otter","Ovenbird","Owl","Owl","Owl","Owl","Owl","Owl","Ox","Oystercatcher","Paca","Pacific gull","Paddy heron","Pademelon","Painted stork","Pale white-eye","Pale-throated three-toed sloth","Pallas's fish eagle","Palm squirrel","Pampa gray fox","Paradoxure","Parakeet","Parrot","Partridge","Peacock","Peacock","Peccary","Peccary","Pelican","Pelican","Pelican","Pelican","Penguin","Penguin","Penguin","Penguin","Peregrine falcon","Phalarope","Phalarope","Phalarope","Phalarope","Phascogale","Phascogale","Pheasant","Pheasant","Pie","Pie","Pied avocet","Pied butcher bird","Pied cormorant","Pied crow","Pied kingfisher","Pig-tailed macaque","Pigeon","Pigeon","Pine siskin","Pine snake","Pine squirrel","Pintail","Pintail","Plains zebra","Platypus","Plover","Plover","Pocket gopher","Polar bear","Polecat","Porcupine","Porcupine","Porcupine","Porcupine","Porcupine","Porcupine","Possum","Possum","Possum","Possum","Possum","Potoroo","Prairie falcon","Praying mantis","Prehensile-tailed porcupine","Pronghorn","Puffin","Puku","Puma","Puma","Puna ibis","Purple grenadier","Purple moorhen","Pygmy possum","Python","Python","Quail","Quoll","Quoll","Rabbit","Raccoon dog","Raccoon","Raccoon","Racer snake","Racer","Racer","Radiated tortoise","Rainbow lory","Rat","Rat","Rat","Rattlesnake","Rattlesnake","Rattlesnake","Raven","Raven","Red and blue macaw","Red brocket","Red deer","Red hartebeest","Red howler monkey","Red kangaroo","Red lava crab","Red meerkat","Red phalarope","Red sheep","Red squirrel","Red-billed buffalo weaver","Red-billed hornbill","Red-billed toucan","Red-billed tropic bird","Red-breasted cockatoo","Red-breasted nuthatch","Red-capped cardinal","Red-cheeked cordon bleu","Red-headed woodpecker","Red-knobbed coot","Red-legged pademelon","Red-necked phalarope","Red-necked wallaby","Red-shouldered glossy starling","Red-tailed cockatoo","Red-tailed hawk","Red-tailed phascogale","Red-tailed wambenger","Red-winged blackbird","Red-winged hawk","Reedbuck","Reindeer","Rhea","Rhea","Rhea","Rhesus macaque","Rhesus monkey","Rhinoceros","Rhinoceros","Rhinoceros","Richardson's ground squirrel","Ring dove","Ring-necked pheasant","Ring-tailed coatimundi","Ring-tailed gecko","Ring-tailed lemur","Ring-tailed possum","Ringtail","Ringtail cat","Ringtail","River wallaby","Roadrunner","Roan antelope","Robin","Robin","Rock dove","Roe deer","Roller","Rose-ringed parakeet","Roseat flamingo","Roseate cockatoo","Royal tern","Rufous tree pie","Rufous-collared sparrow","Russian dragonfly","Sable antelope","Sacred ibis","Saddle-billed stork","Sage grouse","Sage hen","Sally lightfoot crab","Salmon pink bird eater tarantula","Salmon","Sambar","Sandgrouse","Sandhill crane","Sandpiper","Sarus crane","Savanna baboon","Savanna fox","Savannah deer","Savannah deer","Scaly-breasted lorikeet","Scarlet macaw","Scottish highland cow","Screamer","Screamer","Sea birds","Seal","Seal","Seal","Seal","Seal","Secretary bird","Serval","Seven-banded armadillo","Shark","Sheathbill","Sheep","Sheep","Sheep","Shelduck","Shelduck","Short-beaked echidna","Short-nosed bandicoot","Shrew","Shrike","Shrike","Shrike","Sidewinder","Sifaka","Silver gull","Silver-backed fox","Silver-backed jackal","Siskin","Siskin","Skimmer","Skink","Skink","Skua","Skua","Skunk","Skunk","Slender loris","Slender-billed cockatoo","Sloth bear","Sloth","Sloth","Sloth","Sloth","Small Indian mongoose","Small-clawed otter","Small-spotted genet","Small-toothed palm civet","Smith's bush squirrel","Snake","Snake","Snake","Snake","Snake","Snake","Snake","Snake","Snake-necked turtle","Snow goose","Snowy egret","Snowy owl","Snowy sheathbill","Sociable weaver","Sockeye salmon","South African hedgehog","South American meadowlark","South American puma","South American sea lion","Southern black-backed gull","Southern boubou","Southern brown bandicoot","Southern elephant seal","Southern ground hornbill","Southern hairy-nosed wombat","Southern lapwing","Southern right whale","Southern screamer","Southern sea lion","Southern tamandua","Southern white-crowned shrike","Sparrow","Sparrow","Spectacled caiman","Spider","Spoonbill","Spoonbill","Sportive lemur","Spotted deer","Spotted hyena","Spotted wood sandpiper","Spotted-tailed quoll","Springbok","Springbuck","Springhare","Spur-winged goose","Spurfowl","Square-lipped rhinoceros","Squirrel glider","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Squirrel","Stanley bustard","Stanley crane","Starfish","Starling","Starling","Starling","Starling","Steenbok","Steenbuck","Steller sea lion","Steller's sea lion","Stick insect","Stilt","Stone sheep","Stork","Stork","Stork","Stork","Stork","Stork","Stork","Stork","Stork","Stork","Stork","Stork","Striated heron","Striped dolphin","Striped hyena","Striped skunk","Sugar glider","Sulfur-crested cockatoo","Sun gazer","Sunbird","Sungazer","Superb starling","Suricate","Swainson's francolin","Swallow","Swallow-tail gull","Swamp deer","Swan","Swan","Tailless tenrec","Tamandua","Tammar wallaby","Tapir","Tarantula","Tarantula","Tasmanian devil","Tawny eagle","Tawny frogmouth","Tayra","Teal","Tenrec","Tern","Tern","Tern","Tern","Thirteen-lined squirrel","Thomson's gazelle","Thrasher","Three-banded plover","Tiger","Tiger cat","Tiger snake","Timber wolf","Tinamou","Toddy cat","Tokay gecko","Topi","Tortoise","Tortoise","Tortoise","Tortoise","Tortoise","Tortoise","Tortoise","Toucan","Toucan","Tree porcupine","Tropical buckeye butterfly","Trotter","Trumpeter swan","Trumpeter","Trumpeter","Tsessebe","Turaco","Turkey vulture","Turkey","Turkey","Turkey","Turtle","Turtle","Turtle","Turtle","Two-banded monitor","Two-toed sloth","Two-toed tree sloth","Tyrant flycatcher","Uinta ground squirrel","Urial","Verreaux's sifaka","Vervet monkey","Vicuna","Vine snake","Violet-crested turaco","Violet-eared waxbill","Viper","Vulture","Vulture","Vulture","Vulture","Vulture","Vulture","Vulture","Vulture","Vulture","Vulture","Wagtail","Wallaby","Wallaby","Wallaby","Wallaby","Wallaby","Wallaby","Wallaby","Wallaby","Wallaroo","Wambenger","Wapiti","Warthog","Water legaan","Water moccasin","Water monitor","Waterbuck","Waterbuck","Wattled crane","Waved albatross","Waxbill","Waxbill","Waxbill","Weaver","Weaver","Weaver","Weaver","Weaver","Weeper capuchin","Western bearded dragon","Western grey kangaroo","Western lowland gorilla","Western palm tanager","Western patch-nosed snake","Western pygmy possum","Western spotted skunk","Whale","Whale","Whale","Whale","Whip-tailed wallaby","White rhinoceros","White spoonbill","White stork","White-bellied sea eagle","White-browed owl","White-browed sparrow weaver","White-cheeked pintail","White-eye","White-eye","White-faced tree rat","White-faced whistling duck","White-fronted bee-eater","White-fronted capuchin","White-headed vulture","White-lipped peccary","White-mantled colobus","White-necked raven","White-necked stork","White-nosed coatimundi","White-rumped vulture","White-tailed deer","White-tailed jackrabbit","White-throated kingfisher","White-throated monitor","White-throated robin","White-throated toucan","White-winged black tern","White-winged dove","White-winged tern","Wild boar","Wild turkey","Wild water buffalo","Wildebeest","Wolf spider","Wolf","Wolf","Wolf","Wombat","Wombat","Wood pigeon","Woodchuck","Woodcock","Woodpecker","Woodpecker","Woodrat","Woolly-necked stork","Worm snake","Woylie","Yak","Yellow baboon","Yellow mongoose","Yellow-bellied marmot","Yellow-billed hornbill","Yellow-billed stork","Yellow-brown sungazer","Yellow-crowned night heron","Yellow-headed caracara","Yellow-necked spurfowl","Yellow-rumped siskin","Yellow-throated sandgrouse","Zebra","Zebra","Zorilla","Zorro"];function Re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pe(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ee=function(){function e(t,i,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;Re(this,e),i?this.defaultConstructor(i,r,n,a,o):this.randomConstructor(t)}var t,i,r;return t=e,(i=[{key:"defaultConstructor",value:function(e,t,i,r,n){this.type=e,this.name=t,this.modifiers={attack:i,defense:r,hp:n}}},{key:"randomConstructor",value:function(e){switch(this.type=n.a.getWeightedValue(pe),this.name=n.a.getItem(Te),this.modifiers={defense:0,attack:0,hp:0},this.type){case"Armor":this.modifiers.defense=n.a.getUniformInt(e,e+5);break;case"Weapon":this.modifiers.attack=n.a.getUniformInt(e,e+5);break;case"Amulet":this.modifiers.hp=n.a.getUniformInt(e,e+20)}}},{key:"display",get:function(){return"".concat(this.type," of the ").concat(this.name)}},{key:"modifier",get:function(){return this.modifiers.attack||this.modifiers.defense||this.modifiers.hp}}])&&Pe(t.prototype,i),r&&Pe(t,r),e}();function Le(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Be(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var De=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=parseInt(t,10),this.y=parseInt(i,10)}var t,i,r;return t=e,(i=[{key:"matches",value:function(e){var t=Le(e.split(",").map((function(e){return parseInt(e,10)})),2),i=t[0],r=t[1];return this.x===i&&this.y===r&&this}}])&&Be(t.prototype,i),r&&Be(t,r),e}();function We(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ge=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.display=t.display,this.cancelCallback=i,this.bulletPosition=0,this.width=40,this.height=10,this.positionX=20,this.positionY=5,this.reset(),this.listenForInput()}var t,i,r;return t=e,(i=[{key:"reset",value:function(){this.game.rebuild(),this.addOutline(),this.clear(),this.drawTitle(),this.addOptions(),this.redrawBullet()}},{key:"listenForInput",value:function(){window.addEventListener("keydown",this)}},{key:"releaseInput",value:function(){window.removeEventListener("keydown",this)}},{key:"buildModalCallback",value:function(){var e=this;return this.releaseInput(),function(){e.reset(),e.listenForInput()}}},{key:"handleOpenInstructions",value:function(){ye(this.game.display,this.buildModalCallback())}},{key:"handleCancel",value:function(){this.releaseInput(),this.cancelCallback()}},{key:"handleEvent",value:function(e){var t=e.keyCode;if(t in he){var i=he[t];if(0===i||2===i){var r=function(e){return(e+3)%3};0===i&&(this.bulletPosition=r(this.bulletPosition-1)),2===i&&(this.bulletPosition=r(this.bulletPosition+1)),this.redrawBullet()}else"Select"===i?(0===this.bulletPosition&&this.handleCancel(),1===this.bulletPosition&&this.handleOpenInstructions(),2===this.bulletPosition&&(this.releaseInput(),this.game.resetAll())):"Cancel"===i&&this.handleCancel()}}},{key:"redrawBullet",value:function(){for(var e=this.positionY+5;e<this.positionY+10;e++)this.display.draw(this.positionX+19,e),this.display.draw(this.positionX+20,e),this.display.draw(this.positionX+21,e);this.display.draw(this.positionX+20,this.positionY+6+this.bulletPosition,de.BULLET)}},{key:"addOutline",value:function(){for(var e=this.positionX+1;e<this.positionX+this.width;e++)this.display.draw(e,this.positionY,de.MODAL_X),this.display.draw(e,this.positionY+this.height,de.MODAL_X);for(var t=this.positionY+1;t<this.positionY+this.height;t++)this.display.draw(this.positionX,t,de.MODAL_Y),this.display.draw(this.positionX+this.width,t,de.MODAL_Y);this.display.draw(this.positionX,this.positionY,de.MODAL_CORNER_TOP_LEFT),this.display.draw(this.positionX,this.positionY+this.height,de.MODAL_CORNER_BOTTOM_LEFT),this.display.draw(this.positionX+this.width,this.positionY,de.MODAL_CORNER_TOP_RIGHT),this.display.draw(this.positionX+this.width,this.positionY+this.height,de.MODAL_CORNER_BOTTOM_RIGHT)}},{key:"drawTitle",value:function(){var e=this.positionY+1,t=this.positionX+1;this.display.drawText(t+9,e++,"/\\/\\   ___ _ __  _   _ ",this.width-2),this.display.drawText(t+8,e++,"/    \\ / _ \\ '_ \\| | | |",this.width-2),this.display.drawText(t+7,e++,"/ /\\/\\ \\  __/ | | | |_| |",this.width-2),this.display.drawText(t+7,e++,"\\/    \\/\\___|_| |_|\\__,_|",this.width-2)}},{key:"addOptions",value:function(){this.display.drawText(this.positionX+22,this.positionY+5,"\n    Continue\n    Instructions\n    New Game\n    ",this.width-2)}},{key:"clear",value:function(){for(var e=this.positionX+1;e<this.positionX+this.width;e++)for(var t=this.positionY+1;t<this.positionY+this.height;t++)this.display.draw(e,t," ")}}])&&We(t.prototype,i),r&&We(t,r),e}();function He(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Ie(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e){if(e)return"".concat(e.display," (+").concat(e.modifier,")")}var je=function(){function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.x=i,this.y=r,this.stats={maxHp:5,strength:1,dexterity:1},this.gear={Weapon:null,Armor:null,Amulet:null},this.currentHp=5,this.xp=0,this.resolver=function(){}}var t,i,r;return t=e,(i=[{key:"getDamage",value:function(){var e=this.gear.Weapon?this.gear.Weapon.modifier:0;return this.stats.strength+e}},{key:"handleEvent",value:function(e){var t=e.keyCode;81===t&&this.game.devmode&&this.game.nextLevel(),69===t&&this.game.devmode&&this.levelUp(),t in le?(this.game.clearMessage(),t in se?this.handleMovement(t):"Menu"===le[t]?this.handleOpenMenu():"Gear"===le[t]&&this.handleOpenInventory()):this.game.devmode&&console.log("Keycode is ".concat(t))}},{key:"displayStat",value:function(e,t){return"".concat(this.stats[e]+(t?t.modifier:0)).padStart(3)}},{key:"releaseInput",value:function(){window.removeEventListener("keydown",this)}},{key:"listenForInput",value:function(){window.addEventListener("keydown",this)}},{key:"calculateDamage",value:function(e,t){var i=this.stats.dexterity-t.stats.dexterity;if(n.a.getPercentage()<i)return null;if(this.gear.Armor){var r=n.a.getPercentage()/100,a=Math.ceil(e-this.gear.Armor.modifier*r);return a<0?0:a}return e}},{key:"takeDamage",value:function(e,t){var i=this.calculateDamage(e,t);null===i?this.game.sendMessage("You dodged the attack from a ".concat(t.type.toLowerCase())):0===i?this.game.sendMessage("Your armor absorbed all the damage from a ".concat(t.type.toLowerCase())):this.game.sendMessage("A ".concat(t.type.toLowerCase()," hit you for ").concat(i," damage")),this.currentHp-=i,this.currentHp<=0&&(this.currentHp=0),this.draw(),0===this.currentHp&&(this.releaseInput(),this.game.loseGame(t))}},{key:"levelUp",value:function(){var e=this.effectiveMaxHp-this.currentHp;this.stats.maxHp+=3,this.stats.strength+=1,this.stats.dexterity+=1,this.currentHp=this.effectiveMaxHp-Math.ceil(e/2),this.drawHp()}},{key:"addXp",value:function(e){var t=this.level;this.xp+=e,this.level!==t&&(this.game.sendMessage("You are now level ".concat(this.level,"!")),this.levelUp())}},{key:"buildModalCallback",value:function(e){var t=this;return this.releaseInput(),function(i){e&&e(i),t.game.rebuild(),t.listenForInput()}}},{key:"handleOpenInventory",value:function(){var e=this.buildModalCallback(),t="STR:".concat(this.displayStat("strength",this.gear.Weapon),"    ").concat(Fe(this.gear.Weapon)||"No weapon","\n    DEX:").concat(this.displayStat("dexterity",this.gear.Armor),"    ").concat(Fe(this.gear.Armor)||"No armor","\n    HP: ").concat(this.displayStat("maxHp",this.gear.Amulet),"    ").concat(Fe(this.gear.Amulet)||"No amulet","\n    XP: ").concat("".concat(this.xp).padStart(3),"\n    LVL: ").concat("".concat(this.level).padStart(2));new be(this.game.display,e,t,70,5,5)}},{key:"handleOpenMenu",value:function(){new Ge(this.game,this.buildModalCallback())}},{key:"equip",value:function(e){"Amulet"===e.type&&(this.gear.Amulet&&(this.currentHp-=this.gear.Amulet.modifier),this.currentHp+=e.modifier),this.gear[e.type]=e,this.game.sendMessage("New ".concat(e.type," equipped (").concat(e.modifier>=0?"+":"").concat(e.modifier,")"))}},{key:"handleMovement",value:function(e){var t=this,i=He(M[4][se[e]],2),r=i[0],n=i[1],a=this.x+r,o=this.y+n,s="".concat(a,",").concat(o);if(void 0!==this.game.map[s]){var l=this.game.getEnemyAt(s);if(l)return l.takeDamage(this.getDamage(),this),this.resolver();this.draw(a,o);var h=this.game.retrieveContents(this.coordinates);if(h instanceof Ee)if("Potion"===h.type)this.game.sendMessage("Tastes awful, but heals ".concat(h.modifiers.hp,".")),this.currentHp+=h.modifiers.hp,this.currentHp>this.effectiveMaxHp&&(this.currentHp=this.effectiveMaxHp),this.game.removeCache(this.coordinates),this.drawHp(),this.resolver();else{var c=this.buildModalCallback((function(e){e&&(t.game.removeCache(t.coordinates),t.equip(h)),t.resolver()}));new be(this.game.display,c,"".concat(h.display,". Would you like to equip it?"),20,20,5,fe)}else if(h instanceof De){var u=this.buildModalCallback((function(e){e&&t.game.nextLevel()}));new be(this.game.display,u,"Are you ready to delve deeper?",20,20,5,fe)}else this.resolver()}}},{key:"act",value:function(){var e=this;return this.game.storeState(),new Promise((function(t){e.listenForInput(),e.resolver=t}))}},{key:"drawHp",value:function(){this.game.display.drawText(ue-15,0,"HP:");for(var e="".concat(this.currentHp),t="".concat(this.stats.maxHp+(this.gear.Amulet?this.gear.Amulet.modifier:0)),i=ue-12,r=0;r<e.length;r++)this.game.display.draw(i+r,0,e[r]);this.game.display.draw(i+e.length,0,"/");for(var n=0;n<t.length;n++)this.game.display.draw(i+n+1+e.length,0,t[n]);for(var a=0;a<=6-t.length-e.length;a++)this.game.display.draw(i+a+1+e.length+t.length,0," ")}},{key:"draw",value:function(e,t){var i=this.x,r=this.y;this.x=e||i,this.y=t||r,this.game.drawFov(),this.drawHp()}},{key:"coordinates",get:function(){return"".concat(this.x,",").concat(this.y)}},{key:"effectiveMaxHp",get:function(){return this.stats.maxHp+(this.gear.Amulet?this.gear.Amulet.modifier:0)}},{key:"level",get:function(){var e=this;return Object.keys(me).find((function(t){return me[t]>e.xp}))-1}}])&&Ie(t.prototype,i),r&&Ie(t,r),e}();function ze(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function Ye(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Xe(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var qe=function(){function e(t,i,r,a,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.id=Oe(),this.x=i,this.y=r,this.name=o,this.type=a.type;var s=Ne(this.type.split(""),1);this.symbol=s[0],this.stats=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(i),!0).forEach((function(t){Ye(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ze(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},a.stats),this.xp=a.xp,this.item=a.dropPercentage>n.a.getPercentage()?new Ee(this.game.level,"Potion","healer",0,0,this.xp):null,this.color=a.color,this.currentHp=this.stats.maxHp}var t,i,r;return t=e,(i=[{key:"isEnemyInSpace",value:function(e,t){var i=this;return this.game.enemies.filter((function(r){return r.id!==i.id&&r.x===e&&r.y===t})).length}},{key:"act",value:function(){var e=this.game.player.x,t=this.game.player.y,i=this.path;if(i[0]&&!this.isEnemyInSpace(i[0][0],i[0][1])){var r=Ne(i,1),n=Ne(r[0],2),a=n[0],o=n[1];a===e&&o===t?this.game.player.takeDamage(this.stats.strength,this):this.draw(a,o)}}},{key:"draw",value:function(e,t){var i=e||this.x,r=t||this.y;this.x=i,this.y=r,this.game.drawFov()}},{key:"calculateDamage",value:function(e,t){var i=this.stats.dexterity-t.stats.dexterity;return n.a.getPercentage()<i?0:e}},{key:"takeDamage",value:function(e,t){var i=this.calculateDamage(e,t);this.currentHp-=i,this.currentHp<=0&&(this.game.removeEnemy(this),t.addXp(this.xp),this.type===ge.BALROG.type&&(t.releaseInput(),this.game.winGame()))}},{key:"coordinates",get:function(){return"".concat(this.x,",").concat(this.y)}},{key:"path",get:function(){var e=this,t="Troll"===this.type?4:8,i=new U.AStar(this.game.player.x,this.game.player.y,(function(t,i){return"".concat(t,",").concat(i)in e.game.map}),{topology:t}),r=[];return i.compute(this.x,this.y,(function(e,t){return r.push([e,t])})),r.shift(),r}}])&&Xe(t.prototype,i),r&&Xe(t,r),e}();function Ue(e,t,i,r,n,a,o){try{var s=e[a](o),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function Ke(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var a=e.apply(t,i);function o(e){Ue(a,r,n,o,s,"next",e)}function s(e){Ue(a,r,n,o,s,"throw",e)}o(void 0)}))}}function Ve(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],r=!0,n=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(e){n=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Je(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function $e(e,t,i){return($e=Je()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var n=new(Function.bind.apply(e,r));return i&&Ze(n,i.prototype),n}).apply(null,arguments)}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qe(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function et(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function tt(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function it(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}new(function(){function e(){var t=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.display=new R({width:ue,height:ce}),this.devmode=window.location.href.indexOf("devmode")>-1,window.localStorage.getItem("state"))try{this.loadFromState(JSON.parse(window.localStorage.getItem("state")))}catch(e){console.log("error loading from state; clearing"),window.localStorage.clear()}else this.resetAll();document.body.appendChild(this.display.getContainer()),this.devmode||(this.player.releaseInput(),ye(this.display,(function(){t.rebuild(),t.player.listenForInput()})))}var t,i,r,a,o;return t=e,(i=[{key:"loadFromState",value:function(e){var t=this;this.map=e.map,this.level=e.level,this.seenSpaces=e.seenSpaces,this.freeCells=e.freeCells,this.exit=new De(e.exit.x,e.exit.y),this.caches=Object.keys(e.caches).map((function(t){if(!i)return i;var i=e.caches[t],r=new Ee(e.level,i.type,i.name,i.modifiers.attack,i.modifiers.defense,i.modifiers.hp);return r.keyValue=t,r})).filter((function(e){return e})).reduce((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?et(Object(i),!0).forEach((function(t){tt(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):et(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e,tt({},t.keyValue,t))}),{}),this.scheduler=new L.Simple,this.drawWalls(),this.player=new je(this,e.player.x,e.player.y),this.player.stats=e.player.stats,Object.keys(e.player.gear).filter((function(t){return e.player.gear[t]})).forEach((function(i){var r=e.player.gear[i];t.player.equip(new Ee(t.level,r.type,r.name,r.modifiers.attack,r.modifiers.defense,r.modifiers.hp))})),this.player.currentHp=e.player.currentHp,this.player.xp=e.player.xp,this.scheduler.add(this.player,!0),this.enemies=[],e.enemies.forEach((function(e){var i=new qe(t,e.x,e.y,ge[e.type.toUpperCase()],e.name);t.enemies.push(i),t.scheduler.add(i,!0)})),this.init()}},{key:"storeState",value:function(e){if(e)return window.localStorage.clear();var t={map:this.map,level:this.level,seenSpaces:this.seenSpaces,freeCells:this.freeCells,player:this.player,exit:this.exit,caches:this.caches,enemies:this.enemies},i=[];window.localStorage.setItem("state",JSON.stringify(t,(function(e,t){if(null!==t&&t.enemies){if(i.length)return;i.push(t)}return t})))}},{key:"resetAll",value:function(){this.map={},this.level=0,this.seenSpaces={},this.enemies=[],this.exit=null,this.freeCells=[],this.caches={},this.scheduler=new L.Simple,this.generateMap(),this.drawWalls(),this.populatePlayer(),this.populateEnemies(),this.init()}},{key:"rebuild",value:function(){this.drawWalls(),this.display.draw(this.exit[0],this.exit[1],de.LADDER,ne),this.player.draw(),this.enemies.forEach((function(e){return e.draw()}))}},{key:"generateMap",value:function(){var e=this;this.freeCells.length=0,this.caches={},this.map={},new X.Digger(Math.ceil(ue-50+Math.pow(this.level,2)/2),ce-1,{dugPercentage:this.digPercentage,corridorLength:[0,5]}).create(function(t,i,r){if(!r){var n="".concat(t,",").concat(i+1);e.freeCells.push(n),e.map[n]=de.OPEN}}.bind(this)),10!==this.level&&this.addExitLadder();for(var t=Math.ceil(n.a.getNormal(0,this.level+1)),i=0;i<t;i++){var r=this.popOpenFreeSpace();this.caches[r]=new Ee(this.level)}}},{key:"addExitLadder",value:function(){this.exit=$e(De,Qe(this.popOpenFreeSpace().split(",")))}},{key:"popOpenFreeSpace",value:function(){var e=Math.floor(n.a.getUniform()*this.freeCells.length);return this.freeCells.splice(e,1)[0]}},{key:"getEnemyAt",value:function(e){var t=Ve(e.split(",").map((function(e){return parseInt(e,10)})),2),i=t[0],r=t[1];return this.enemies.filter((function(e){return e.x===i&&e.y===r}))[0]}},{key:"drawWalls",value:function(){for(var e=0;e<ue;e++)for(var t=1;t<ce;t++)this.seenSpaces["".concat(e,",").concat(t)]||this.display.draw(e,t,de.WALL)}},{key:"lightPasses",value:function(e,t){return this.map["".concat(e,",").concat(t)]}},{key:"drawFov",value:function(){var e=this,t=Oe();new W.PreciseShadowcasting(this.lightPasses.bind(this)).compute(this.player.x,this.player.y,500,(function(i,r){var n="".concat(i,",").concat(r);e.seenSpaces[n]=t,e.redrawSpace(i,r,!e.map[n])})),Object.keys(this.seenSpaces).filter((function(i){return e.seenSpaces[i]!==t})).forEach((function(t){var i=Ve(t.split(",").map((function(e){return parseInt(e,10)})),2),r=i[0],n=i[1];e.redrawSpace(r,n,!0)}))}},{key:"redrawSpace",value:function(e,t,i){var r=de.OPEN,n=oe,a="".concat(e,",").concat(t);if(this.player.x===e&&this.player.y===t)r=de.PLAYER,n=te;else if(!i&&this.enemies.find((function(i){return i.x===e&&i.y===t}))){var o=this.enemies.find((function(i){return i.x===e&&i.y===t}));n=o.color,r=o.symbol}else this.caches[a]?(r=de[this.caches[a].type.toUpperCase()],n=ie):this.exit.matches(a)?(r=de.LADDER,n=ne):this.map[a]||(r=de.WALL);n=i?we()(n).darken(30).toString():n,this.display.draw(e,t,r,n)}},{key:"sendMessage",value:function(e){this.clearMessage(),this.display.drawText(0,0,e)}},{key:"clearMessage",value:function(){for(var e=0;e<ue-15;e++)this.display.draw(e,0," ")}},{key:"retrieveContents",value:function(e){return this.caches[e]||this.exit.matches(e)}},{key:"removeCache",value:function(e){delete this.caches[e]}},{key:"removeEnemy",value:function(e){var t="".concat(e.x,",").concat(e.y);this.caches[t]||(this.caches[t]=e.item);var i=this.caches[t];this.sendMessage("".concat(e.type," died").concat(i?", leaving behind a potion!":"")),this.scheduler.remove(e),this.enemies=this.enemies.filter((function(t){return t.id!==e.id})),this.drawFov()}},{key:"playAgainCallback",value:function(e){this.resetAll(),e||this.player.handleOpenMenu()}},{key:"loseGame",value:function(e){this.storeState(!0),this.scheduler.clear();var t="You have lost after taking a brutal blow from a roaming ".concat(e.type," named ").concat(e.name,".\n\nWould you like to play again?");new be(this.display,this.playAgainCallback.bind(this),t,40,20,5,fe)}},{key:"winGame",value:function(){this.storeState(!0),this.scheduler.clear(),new be(this.display,this.playAgainCallback.bind(this),"You have defeated Gothmog, Lord of the Balrogs! Would you like to play again?",40,20,5,fe)}},{key:"populateEnemies",value:function(){if(this.level<9)for(var e=0;e<=(this.level>5?5:this.level);e++){var t=this.createActor(qe,[ge.GOBLIN,n.a.getItem(K)]);t.draw(),this.enemies.push(t),this.scheduler.add(t,!0)}if(this.level>=1&&this.level<8)for(var i=this.level-5,r=i>0?this.level-i:this.level,a=0;a<r;a++){var o=this.createActor(qe,[ge.SKELETON,n.a.getItem($)]);o.draw(),this.enemies.push(o),this.scheduler.add(o,!0)}if(this.level>=4)for(var s=0;s<this.level-3;s++){var l=this.createActor(qe,[ge.TROLL,n.a.getItem(V)]);l.draw(),this.enemies.push(l),this.scheduler.add(l,!0)}if(this.level>7)for(var h=0;h<=this.level-7;h++){var c=this.createActor(qe,[ge.DRAGON,n.a.getItem(J)]);c.draw(),this.enemies.push(c),this.scheduler.add(c,!0)}if(10===this.level){var u=this.createActor(qe,[ge.BALROG,"Gothmog"]);u.draw(),this.enemies.push(u),this.scheduler.add(u,!0)}}},{key:"nextLevel",value:function(){if(this.scheduler.clear(),this.scheduler.add(this.player,!0),this.level+=1,this.enemies.length=0,this.generateMap(),this.populateEnemies(),this.drawLevel(),this.seenSpaces={},!this.map[this.player.coordinates]){var e=Ve(this.popOpenFreeSpace().split(",").map((function(e){return parseInt(e,10)})),2),t=e[0],i=e[1];this.player.draw(t,i)}this.drawWalls(),this.drawFov()}},{key:"createActor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=this.popOpenFreeSpace(),r=i.split(",").map((function(e){return parseInt(e,10)})),n=Ve(r,2),a=n[0],o=n[1];return $e(e,[this,a,o].concat(Qe(t)))}},{key:"drawLevel",value:function(){this.display.draw(ue-4,0,"L");for(var e="".concat(this.level).padStart(3,0),t=3;t>0;t--)this.display.draw(ue-t,0,e[e.length-t])}},{key:"populatePlayer",value:function(){this.player=this.createActor(je),this.scheduler.add(this.player,!0)}},{key:"nextTurn",value:(o=Ke(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.scheduler.next()){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,t.act();case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"init",value:(a=Ke(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.drawWalls(),this.player.draw(),this.drawLevel();case 3:return e.next=6,this.nextTurn();case 6:if(e.sent){e.next=9;break}return e.abrupt("break",11);case 9:e.next=3;break;case 11:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"digPercentage",get:function(){return.1*this.level}}])&&it(t.prototype,i),r&&it(t,r),e}())}]);